Function:
  Title: An ASIM Function to set all Target User IDs  
  Version: '0.1'
  LastUpdated: Apr 27th 2022
References:
- Title: ASIM
  Link: https://aka.ms/AboutASIM
- Title: KQL Invoke operator
  Link: https://docs.microsoft.com/azure/data-explorer/kusto/query/invokeoperator
Description: |
  This ASIM tabular function sets the Target User ID fields (TargetUserSID, TargetUserUID, TargetUserAadId, TargetUserAwdId, and TargetUserOktaId) based on the existing fields and the TargetUserIdType. The function is useful if the original parsers set only the TargetUserId and TargetUserIdType fields, but not the specific IF fields, and your query needs the specific ID fields.The function is invoked using the [invoke operator](https://docs.microsoft.com/azure/data-explorer/kusto/query/invokeoperator) and requires the source table to have a TimeGenerated field.  
FunctionName: ASIM_ExpandTargetUserIDs
EquivalentBuiltInFunction: _ASIM_ExpandTargetUserIDs
FunctionParams:
  - Name: T:(TimeGenerated:datetime,TargetUserIdType:string,TargetUserId:string)
    Type: table

FunctionQuery: |
  T
  | extend 
    TargetUserAadId = column_ifexists('TargetUserAadId',''),
    TargetUserSID = column_ifexists('TargetUserSID',''),
    TargetUserUID = column_ifexists('TargetUserUID',''),
    TargetUserAwsId = column_ifexists('TargetUserAwsId',''),
    TargetUserOktaId = column_ifexists('TargetUserOktaId','')
  | extend 
    TargetUserAadId = case(TargetUserAadId != "", TargetUserAadId, TargetUserIdType =~ "AADID", TargetUserId, ""),
    TargetUserSID = case(TargetUserSID != "", TargetUserSID, TargetUserIdType =~ "SID", TargetUserId, ""),
    TargetUserUID = case(TargetUserUID != "", TargetUserUID, TargetUserIdType =~ "UID", TargetUserId, ""),
    TargetUserAwsId = case(TargetUserAwsId != "", TargetUserAwsId, TargetUserIdType =~ "AWSId", TargetUserId, ""),
    TargetUserOktaId = case(TargetUserOktaId != "", TargetUserOktaId, TargetUserIdType =~ "OktaId", TargetUserId, "")

