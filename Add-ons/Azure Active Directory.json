{
  "properties": {
    "lenses": {
      "0": {
        "order": 0,
        "parts": {
          "0": {
            "position": {
              "x": 0,
              "y": 0,
              "colSpan": 18,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">General overview</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "1": {
            "position": {
              "x": 19,
              "y": 0,
              "colSpan": 7,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Users Activity</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "2": {
            "position": {
              "x": 0,
              "y": 1,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//Top AzureActiveDirectory operations\r\nOfficeActivity\r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| summarize count() by Operation\r\n| order by count_\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Operation",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "e5af5953-8c1e-436a-ae56-a76ff225ea07"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Operations by type",
                  "PartSubTitle": "-"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "3": {
            "position": {
              "x": 6,
              "y": 1,
              "colSpan": 12,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//AzureActiveDirectory operations over time\nOfficeActivity\n| where TimeGenerated >= ago(14d)\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Operation\n| extend Per = toreal(Current_Week) / toreal(Previous_Week)\n| extend Percentage = iff(Per > 1, strcat(\"+\", Per, \"%\"), strcat(\"-\", Per, \"%\"))\n| project Operation, Previous_Week, Current_Week, Percentage\n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "4ee3fbd9-18e7-402f-a1df-d7ef71a7b74a"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Activity per operation",
                  "PartSubTitle": "Week Over Week",
                  "Query": "//AzureActiveDirectory operations over time\nOfficeActivity\n| where TimeGenerated >= ago(14d)\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Operation\n| extend Per = iff(Current_Week > Previous_Week, toreal(Current_Week) / Previous_Week, toreal(Previous_Week) / Current_Week)\n| extend sign = iff(Current_Week > Previous_Week, \"+\", \"-\")\n| extend Percentage = iff(Current_Week != 0 and Previous_Week != 0 and Previous_Week != Current_Week, strcat(sign, extract(@\"(\\d*(\\.\\d{1,2}|$))\",Â 1, tostring((Per -1 )*100)), \"%\"), \"No Percentage - 0\")\n| project Operation, Previous_Week, Current_Week, Percentage\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "4": {
            "position": {
              "x": 19,
              "y": 1,
              "colSpan": 7,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//AzureActiveDirectory operations over time\r\nOfficeActivity\r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| summarize Events = count() by bin_at(TimeGenerated, 1h, now()) \r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "Events",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "3e977483-2bd7-4c13-a17b-ac02b5886bbc"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Line"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Activity over time",
                  "PartSubTitle": "-",
                  "Query": "//AzureActiveDirectory operations over time\nOfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize Events = count() by bin_at(TimeGenerated, 1d, now()) \n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "5": {
            "position": {
              "x": 0,
              "y": 5,
              "colSpan": 18,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Additions, Updates, Deletions</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "6": {
            "position": {
              "x": 19,
              "y": 5,
              "colSpan": 7,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//AzureActiveDirectory operations over time\r\nOfficeActivity\r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| summarize Amount = count() by UserId\r\n| top 10 by Amount \r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "c6004e80-d6bb-475d-aba9-bd817d97de00"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Top 10 active users",
                  "PartSubTitle": "-",
                  "Query": "//AzureActiveDirectory operations over time\nOfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize Amount = count() by UserId\n| top 10 by Amount\n| project User_ID =  UserId, Amount\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "7": {
            "position": {
              "x": 0,
              "y": 6,
              "colSpan": 18,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize deletions = countif(Operation contains \"Delete\"), additions = countif(Operation contains \"add\"), updates = countif(Operation contains \"Update\") by bin_at(TimeGenerated, 1d, now())\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P7D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "deletions",
                        "type": "Int64"
                      },
                      {
                        "name": "additions",
                        "type": "Int64"
                      },
                      {
                        "name": "updates",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "d95e9c41-ab8b-44e5-931e-3511521bafcd"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Line"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Additions VS Updates VS Deletions",
                  "PartSubTitle": "Over the past week",
                  "Query": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| summarize additions = countif(Operation contains \"add\"), updates = countif(Operation contains \"Update\"), deletions = countif(Operation contains \"Delete\") by bin_at(TimeGenerated, 1d, now())"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "7d"
                  }
                }
              }
            }
          },
          "8": {
            "position": {
              "x": 0,
              "y": 10,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation contains \"add\"\r\n| summarize count() by Operation, bin_at(TimeGenerated, 1h, now()) \r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "Operation",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "412f8581-42fe-4c76-850c-9aec4004d2b4"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "GroupedBar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Adding operations",
                  "PartSubTitle": "by type, over time"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "9": {
            "position": {
              "x": 6,
              "y": 10,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation contains \"update\"\r\n| summarize count() by Operation, bin_at(TimeGenerated, 1h, now()) \r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "Operation",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "02bfb13a-3fa6-4cb0-ae06-80af5dd6ab54"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "GroupedBar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Updating operations",
                  "PartSubTitle": "by type, over time"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "10": {
            "position": {
              "x": 12,
              "y": 10,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation contains \"delete\"\r\n| summarize count() by Operation, bin_at(TimeGenerated, 1h, now()) \r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "Operation",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "4a895dc8-34f0-4c73-b5bc-f9eed7449253"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "GroupedBar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Deleting operations ",
                  "PartSubTitle": "by type, over time"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "11": {
            "position": {
              "x": 19,
              "y": 10,
              "colSpan": 7,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//Activity by User type\r\nOfficeActivity\r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| summarize count() by UserType\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "UserType",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "905469fc-2a41-4637-ba34-84feb358bca7"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Activity by user type",
                  "PartSubTitle": "-"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "12": {
            "position": {
              "x": 0,
              "y": 14,
              "colSpan": 18,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Users - Groups</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "13": {
            "position": {
              "x": 19,
              "y": 14,
              "colSpan": 7,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">User Logons</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "14": {
            "position": {
              "x": 0,
              "y": 15,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation contains \"user\"\r\n| summarize count() by Operation\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Operation",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "77d6ebe2-5afc-4f1a-9592-d7bca00a63e7"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User operations",
                  "PartSubTitle": "By type",
                  "Query": "OfficeActivity \n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation contains \"user\" and Operation != \"UserLoggedIn\"\n| summarize count() by Operation\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "15": {
            "position": {
              "x": 6,
              "y": 15,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation contains \"user\"\n| top 10 by TimeGenerated desc\n| project Operation, UserId , ResultStatus\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "879f26ca-215c-4624-b50e-ac49916c4b8a"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User operation events",
                  "PartSubTitle": "Last 10",
                  "Query": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation contains \"user\" and Operation != \"UserLoggedIn\"\n| top 10 by TimeGenerated desc\n| project Operation, UserId , ResultStatus\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "16": {
            "position": {
              "x": 12,
              "y": 15,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation == \"Add user.\"\r\n| project TimeGenerated, User_Name=todynamic(AADTarget)[0].ID\r\n| summarize by tostring(User_Name), TimeGenerated\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "bc8f871e-fa66-4fb3-8eb4-b94096c200c6"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "New users",
                  "PartSubTitle": "User name, Time - last 10",
                  "Query": "OfficeActivity \n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation == \"Add user.\"\n| project TimeGenerated, User_Name=todynamic(AADTarget)[0].ID\n| summarize by tostring(User_Name), TimeGenerated\n| limit 10\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "17": {
            "position": {
              "x": 19,
              "y": 15,
              "colSpan": 7,
              "rowSpan": 3
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n//| summarize count() by Operation\n| where Operation == \"UserLoggedIn\" \n| summarize Logons = count() by bin_at(TimeGenerated, 1h, now()) \n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "Logons",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "fc6b0018-e776-429e-91dc-2cff0721eab9"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Line"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User logons",
                  "PartSubTitle": "Fail VS Success",
                  "Query": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation == \"UserLoggedIn\"\n| summarize Logons = count() by ResultStatus, bin_at(TimeGenerated, 1h, now())"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "18": {
            "position": {
              "x": 19,
              "y": 18,
              "colSpan": 7,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Failed Operations</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "19": {
            "position": {
              "x": 0,
              "y": 19,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//AzureActiveDirectory operations over time\r\nOfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation contains \"group\"\r\n| summarize count() by Operation\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Operation",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "17896e4c-0872-41d4-bbad-f8bc61fb9cb1"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Group operations",
                  "PartSubTitle": "By type"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "20": {
            "position": {
              "x": 6,
              "y": 19,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation contains \"group\"\n| top 10 by TimeGenerated desc\n| project Operation, UserId , ResultStatus\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "82bb1da4-fc89-4c3f-b356-05315803f703"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Group operation events",
                  "PartSubTitle": "Last 10"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "21": {
            "position": {
              "x": 12,
              "y": 19,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "OfficeActivity \r\n| where OfficeWorkload == \"AzureActiveDirectory\"\r\n| where Operation == \"Add group.\"\r\n| project TimeGenerated, Group_Name=todynamic(AADTarget)[0].ID\r\n| summarize by tostring(Group_Name), TimeGenerated"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "5b5d670e-188c-40e1-aa17-bbbea21e86e6"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "New groups",
                  "PartSubTitle": "Group name, Time - last 10",
                  "Query": "OfficeActivity \n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where Operation == \"Add group.\"\n| project TimeGenerated, Group_Name=todynamic(AADTarget)[0].ID\n| summarize by tostring(Group_Name), TimeGenerated\n| limit 10"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "22": {
            "position": {
              "x": 19,
              "y": 19,
              "colSpan": 7,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//Failed operations by operation\nOfficeActivity\n| where OfficeWorkload == \"AzureActiveDirectory\"\n| where ResultStatus == \"Failure\"\n| summarize count() by Operation, bin_at(TimeGenerated, 1h, now())\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "Operation",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/4fd58bf4-be63-456d-a149-f3df36dd2145"
                },
                {
                  "name": "PartId",
                  "value": "db0b2916-3d18-46eb-8f8b-a9a2139c46e7"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "_"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Failed operations by type",
                  "PartSubTitle": "-"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          }
        }
      }
    }
  },
  "apiVersion": "2015-08-01-preview"
}