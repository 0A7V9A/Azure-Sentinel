{
  "properties": {
    "lenses": {
      "0": {
        "order": 0,
        "parts": {
          "0": {
            "position": {
              "x": 0,
              "y": 0,
              "colSpan": 25,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">User Logons</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "1": {
            "position": {
              "x": 0,
              "y": 1,
              "colSpan": 7,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where EventID in (4624, 4625)\r\n| extend EventName = iff(EventID == 4624, \"Success\" , \"Failed\") \r\n| summarize NumLogons = count() by bin(TimeGenerated, 1h), tostring(EventName)\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "NumLogons",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "EventName",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/e7527756-4347-4b85-8f6c-7ea5714ae65c/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/1c64bb6e-24b5-4e9f-8f7f-8e7c6c51f162"
                },
                {
                  "name": "PartId",
                  "value": "3890a09c-f87e-4e67-b4e2-78a71c2450bd"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Bar"
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Logons per hour ",
                  "PartSubTitle": "Fail VS Success",
                  "Query": "SecurityEvent\n| where EventID in (4624, 4625) and AccountType == 'User'\n| extend EventName = iff(EventID == 4624, \"Success\" , \"Fail\") \n| summarize NumLogons = count() by bin_at(TimeGenerated, 1h, now()), EventName"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "2": {
            "position": {
              "x": 7,
              "y": 1,
              "colSpan": 7,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "let top5 = SecurityEvent\n| where EventID == 4625 and AccountType == 'User'\n| extend Account_Name = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| summarize Attempts = count() by Account_Name\n| where Account_Name != \"\"\n| top 5 by Attempts \n| summarize makelist(Account_Name);\nSecurityEvent\n| where EventID == 4625 and AccountType == 'User'\n| extend Name = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| extend Account_Name = iff(Name in (top5), Name, \"Other\")\n| where Account_Name != \"\"\n| summarize Attempts = count() by Account_Name\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Account_Name",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "Attempts",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "ecfeb0d5-22d2-4635-899a-0a5d45e21e01"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Failure logon accounts",
                  "PartSubTitle": "Top 5 - by user names"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "3": {
            "position": {
              "x": 14,
              "y": 1,
              "colSpan": 13,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent \r\n| where EventID in (4625, 4624)\r\n| where TimeGenerated >= ago(14d)\r\n| extend status = iff(EventID == 4624, \"Success\", \"Failed\") \r\n| summarize count() by bin(TimeGenerated, 1d)\r\n| extend Week = iff(TimeGenerated>ago(7d), \"This Week\", \"Last Week\"), TimeGenerated = iff(TimeGenerated>ago(7d), TimeGenerated, TimeGenerated + 7d)\n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [
                      {
                        "name": "Week",
                        "type": "String"
                      }
                    ],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "1bc21a9a-00fc-4e12-ae96-2686c7fbb7c1"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Line"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Logons per day",
                  "PartSubTitle": "Week Over Week",
                  "Query": "SecurityEvent\n| where EventID in (4625, 4624)\n| where TimeGenerated >= ago(14d)\n| summarize count() by bin_at(TimeGenerated, 1d, now())\n| extend Week = iff(TimeGenerated>=ago(7d), \"This Week\", \"Last Week\"), TimeGenerated = iff(TimeGenerated>=ago(7d), TimeGenerated, TimeGenerated + 7d)"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "utc",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "4": {
            "position": {
              "x": 0,
              "y": 5,
              "colSpan": 7,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "let succeeded = SecurityEvent\n| where AccountType == \"User\"\n| where EventID == 4624\n| summarize Succeeded = count() by IpAddress;\nSecurityEvent\n| where AccountType == \"User\"\n| where EventID in (4624, 4625)\n| summarize numAccounts = dcount(Account), numAttempts = count() by IpAddress\n| join kind=leftouter (succeeded) on IpAddress\n| project-away IpAddress1\n| order by Succeeded\n| sort by numAttempts desc nulls last \n| take 5\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/e7527756-4347-4b85-8f6c-7ea5714ae65c/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/1c64bb6e-24b5-4e9f-8f7f-8e7c6c51f162"
                },
                {
                  "name": "PartId",
                  "value": "00ee3d4f-a38f-4f06-8558-922a74e8ceba"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Most suspicious failed logons by IP",
                  "PartSubTitle": "Top 10",
                  "Query": "SecurityEvent\n| where AccountType == \"User\"\n| where EventID in (4624, 4625)\n| summarize Unique_Accounts = dcount(Account), Attempts = count(), Succeeded=countif(EventID == 4624), Failed=countif(EventID == 4625)  by IpAddress\n| where Failed > 0\n| order by Succeeded>0, todouble(Succeeded)/Attempts asc, Attempts desc\n| project IP = IpAddress, Succeeded, Attempts, Unique_Accounts\n| take 10"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "5": {
            "position": {
              "x": 7,
              "y": 5,
              "colSpan": 7,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "let attempts = SecurityEvent\n| where (EventID == 4625 or EventID == 4624) and AccountType == 'User'\n| extend AccountName = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| summarize Attempts = count() by AccountName;\nlet failed = SecurityEvent\n| where EventID == 4625 and AccountType == 'User'\n| extend AccountName = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| summarize Failed = count() by AccountName;\nlet success = SecurityEvent\n| where EventID == 4624 and AccountType == 'User'\n| extend AccountName = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| summarize Succeeded = count() by AccountName;\nattempts\n| join kind=fullouter failed on AccountName\n| join kind=fullouter success on AccountName\n| project-away AccountName1, AccountName2\n| order by Attempts\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/e7527756-4347-4b85-8f6c-7ea5714ae65c/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/1c64bb6e-24b5-4e9f-8f7f-8e7c6c51f162"
                },
                {
                  "name": "PartId",
                  "value": "54c9620b-b1b8-4bff-9d63-2753956b5488"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Logon attempts - Fail VS Success",
                  "PartSubTitle": " Top 10 - per user account name",
                  "Query": "SecurityEvent\n| where EventID in (4625, 4624) and AccountType == 'User'\n| extend AccountName = extract(@\"^(.*\\\\)?([^@]*)(@.*)?$\", 2, tolower(Account))\n| summarize Attempts = count(), Failed = countif(EventID == 4625), Succeeded = countif(EventID == 4624) by AccountName\n| where AccountName != \"\"\n| top 10 by Attempts\n| project Account_Name = AccountName, Attempts, Failed, Succeeded"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "6": {
            "position": {
              "x": 14,
              "y": 5,
              "colSpan": 3,
              "rowSpan": 6
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where EventID in (4624, 4625)\r\n| summarize count() by  LogonTypeName\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "21a79a90-ee2b-4d43-8509-7ebea3df95e4"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "Contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User logons by type",
                  "PartSubTitle": "-",
                  "Query": "SecurityEvent\n| where EventID in (4624, 4625)\n| where AccountType == \"User\" \n| summarize Amount = count() by  LogonTypeName"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "7": {
            "position": {
              "x": 17,
              "y": 5,
              "colSpan": 6,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where AccountType == 'User' and EventID == 4625\n| extend Reason = case(\n                        SubStatus == '0xc0000064', 'User name does not exist',\n                        SubStatus == '0xc000005e', 'No logon servers available to service the logon request',\n                        SubStatus == '0xc0000062', 'Account name is not properly formatted',\n                        SubStatus == '0xc0000064', 'Account name does not exist',\n                        SubStatus == '0xc000006a', 'Incorrect password',\n                        SubStatus == '0xc000006d', 'Bad user name or password',\n                        SubStatus == '0xc000006f', 'User logon blocked by account restriction',\n                        SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',\n                        SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',\n                        SubStatus == '0xc0000071', 'Password has expired',\n                        SubStatus == '0xc0000072', 'Account is disabled',\n                        SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',\n                        SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',\n                        SubStatus == '0xc0000193', 'Account has expirated',\n                        SubStatus == '0xc0000224', 'User is required to change password at next logon',\n                        SubStatus == '0xc0000234', 'Account is currently locked out',\n                        strcat('Unknown reason substatus: ', SubStatus))\n| summarize count() by Reason\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Reason",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/e7527756-4347-4b85-8f6c-7ea5714ae65c/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/1c64bb6e-24b5-4e9f-8f7f-8e7c6c51f162"
                },
                {
                  "name": "PartId",
                  "value": "fd748a71-fef1-4b96-b7d9-d74a2e47c2c7"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Failed user logons by reason",
                  "PartSubTitle": "-",
                  "Query": "SecurityEvent\n| where AccountType == 'User' and EventID == 4625\n| extend Reason = case(\n                        SubStatus == '0xc000005e', 'No logon servers available to service the logon request',\n                        SubStatus == '0xc0000062', 'Account name is not properly formatted',\n                        SubStatus == '0xc0000064', 'Account name does not exist',\n                        SubStatus == '0xc000006a', 'Incorrect password',\n                        SubStatus == '0xc000006d', 'Bad user name or password',\n                        SubStatus == '0xc000006f', 'User logon blocked by account restriction',\n                        SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',\n                        SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',\n                        SubStatus == '0xc0000071', 'Password has expired',\n                        SubStatus == '0xc0000072', 'Account is disabled',\n                        SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',\n                        SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',\n                        SubStatus == '0xc0000193', 'Account has expirated',\n                        SubStatus == '0xc0000224', 'User is required to change password at next logon',\n                        SubStatus == '0xc0000234', 'Account is currently locked out',\n                        strcat('Unknown reason substatus: ', SubStatus))\n| summarize count() by Reason\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "8": {
            "position": {
              "x": 23,
              "y": 5,
              "colSpan": 4,
              "rowSpan": 4
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where AccountType == 'User' and EventID == 4625\n| extend Reason = case(\n                        SubStatus == '0xc0000064', 'User name does not exist',\n                        SubStatus == '0xc000005e', 'No logon servers available to service the logon request',\n                        SubStatus == '0xc0000062', 'Account name is not properly formatted',\n                        SubStatus == '0xc0000064', 'Account name does not exist',\n                        SubStatus == '0xc000006a', 'Incorrect password',\n                        SubStatus == '0xc000006d', 'Bad user name or password',\n                        SubStatus == '0xc000006f', 'User logon blocked by account restriction',\n                        SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',\n                        SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',\n                        SubStatus == '0xc0000071', 'Password has expired',\n                        SubStatus == '0xc0000072', 'Account is disabled',\n                        SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',\n                        SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',\n                        SubStatus == '0xc0000193', 'Account has expirated',\n                        SubStatus == '0xc0000224', 'User is required to change password at next logon',\n                        SubStatus == '0xc0000234', 'Account is currently locked out',\n                        strcat('Unknown reason substatus: ', SubStatus))\n| summarize count() by Reason\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Reason",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "count_",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/e7527756-4347-4b85-8f6c-7ea5714ae65c/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/1c64bb6e-24b5-4e9f-8f7f-8e7c6c51f162"
                },
                {
                  "name": "PartId",
                  "value": "7354fddd-0660-489a-8991-eded01abac65"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Accounts locked out",
                  "PartSubTitle": "-",
                  "Query": "SecurityEvent\n| where EventID == 4740"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "9": {
            "position": {
              "x": 17,
              "y": 9,
              "colSpan": 10,
              "rowSpan": 2
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "let timescope = ago(30d);\nSecurityEvent\n| where TimeGenerated >= timescope\n| where EventID == 4724 \n| summarize Resets = count() by bin_at(TimeGenerated, 1d, now())\n| render timechart \n"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "TimeGenerated",
                      "type": "DateTime"
                    },
                    "yAxis": [
                      {
                        "name": "Resets",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "0f5f336f-15f1-46ef-92dc-33089a2d16c2"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "Contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsChart"
                },
                {
                  "name": "SpecificChart",
                  "value": "Line"
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Password reset",
                  "PartSubTitle": "Per day over last month"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "10": {
            "position": {
              "x": 0,
              "y": 11,
              "colSpan": 25,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Users Operations</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "11": {
            "position": {
              "x": 0,
              "y": 12,
              "colSpan": 7,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "//Users Account Management over time\nSecurityEvent\n| where EventID in (4720, 4722, 4725, 4726, 4240, 4767)\n| extend Operation = case(                         EventID == 4720, 'Created',                         EventID == 4722, 'Enabled',                         EventID == 4725, 'Disabled',                         EventID == 4726, 'Deleted',                         EventID == 4740, 'Locked Out',                         EventID == 4767, 'Unlocked',                         'Unknown')\n| summarize Amount = count() by Operation\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Dimensions",
                  "value": {
                    "xAxis": {
                      "name": "Operation",
                      "type": "String"
                    },
                    "yAxis": [
                      {
                        "name": "Amount",
                        "type": "Int64"
                      }
                    ],
                    "splitBy": [],
                    "aggregation": "Sum"
                  }
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "54361477-319b-4418-987c-f183d70405f3"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "Contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsDonut"
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Users account operations activity",
                  "PartSubTitle": "By type",
                  "Query": "//Users Account Management over time\nSecurityEvent\n| where EventID in (4720, 4722, 4725, 4726, 4240, 4767)\n| extend Operation = case(                         EventID == 4720, 'User Created',                         EventID == 4722, 'User Enabled',                         EventID == 4725, 'User Disabled',                         EventID == 4726, 'User Deleted',                         EventID == 4740, 'User Locked Out',                         EventID == 4767, 'User Unlocked',                         'Unknown')\n| summarize Amount = count() by Operation\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "12": {
            "position": {
              "x": 7,
              "y": 12,
              "colSpan": 7,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where EventID in (4720, 4722, 4725, 4726, 4738, 4240, 4767)\n| order by TimeGenerated\n| extend EventType = case(\n                        EventID == 4720, 'User account created',\n                        EventID == 4722, 'User account enabled',\n                        EventID == 4725, 'User account disabled',\n                        EventID == 4726, 'User account deleted',\n                        EventID == 4738, 'User account changed',\n                        EventID == 4767, 'User account unlocked',\n                        EventID == 4740, 'User account locked out',\n                        strcat('Unkown Event ID', EventID))\n| project TimeGenerated, EventType, Computer, Account\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "18102f77-c55f-47eb-8ea2-b50a61bfdd18"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User operation events",
                  "PartSubTitle": "Last 10 - Created, Enabled, Disabled, Deleted, Locked Out, Unlocked",
                  "Query": "SecurityEvent\n| where EventID in (4720, 4722, 4725, 4726, 4240, 4767)\n| order by TimeGenerated\n| extend EventType = case(\n                        EventID == 4720, 'User account created',\n                        EventID == 4722, 'User account enabled',\n                        EventID == 4725, 'User account disabled',\n                        EventID == 4726, 'User account deleted',\n                        EventID == 4767, 'User account unlocked',\n                        EventID == 4740, 'User account locked out',\n                        strcat('Unkown Event ID', EventID))\n| project Time_Generated = TimeGenerated, Event_Type = EventType, Computer, Account\n| limit 10\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "13": {
            "position": {
              "x": 14,
              "y": 12,
              "colSpan": 13,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where EventID in (4720, 4722, 4725, 4726, 4738, 4240, 4767)\r\n| order by TimeGenerated\r\n| extend EventType = case(\r\n                        EventID == 4720, 'User account created',\r\n                        EventID == 4722, 'User account enabled',\r\n                        EventID == 4725, 'User account disabled',\r\n                        EventID == 4726, 'User account deleted',\r\n                        EventID == 4738, 'User account changed',\r\n                        EventID == 4767, 'User account unlocked',\r\n                        EventID == 4740, 'User account locked out',\r\n                        strcat('Unkown Event ID', EventID))\r\n| project EventType, Computer\r\n| evaluate pivot(EventType, count(EventType))\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "3f1abe3a-a345-407f-9d05-d7addcfc5e4b"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "User operations per machine",
                  "PartSubTitle": "Following events : Created, Enabled, Disabled, Deleted, Locked Out, Unlocked",
                  "Query": "SecurityEvent\n| where EventID in (4720, 4722, 4725, 4726, 4240, 4767)\n| extend EventType = case(\n                        EventID == 4720, 'User account created',\n                        EventID == 4722, 'User account enabled',\n                        EventID == 4725, 'User account disabled',\n                        EventID == 4726, 'User account deleted',\n                        EventID == 4767, 'User account unlocked',\n                        EventID == 4740, 'User account locked out',\n                        strcat('Unkown Event ID', EventID))\n| project EventType, Computer\n| evaluate pivot(EventType, count(EventType))\n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "14": {
            "position": {
              "x": 0,
              "y": 17,
              "colSpan": 25,
              "rowSpan": 1
            },
            "metadata": {
              "inputs": [],
              "type": "Extension/HubsExtension/PartType/MarkdownPart",
              "settings": {
                "content": {
                  "settings": {
                    "content": "<div style=\"font-size:300%;\">Machine Logons</div>",
                    "title": "",
                    "subtitle": ""
                  }
                }
              }
            }
          },
          "15": {
            "position": {
              "x": 0,
              "y": 18,
              "colSpan": 7,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where EventID == 4624\n| where TimeGenerated >= ago(7d)\n| summarize Current_Week_Logons = count(EventID) by Computer\n| join kind= fullouter (\n    SecurityEvent\n    | where EventID == 4624\n    | where TimeGenerated >= ago(14d) and TimeGenerated < ago(7d)\n    | summarize Previous_Week_Logons = count(EventID) by Computer\n) on Computer \n| extend Computer = iff(Computer == \"\", Computer1, Computer)\n| project Computer, Current_Week_Logons, Previous_Week_Logons \n"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "8198fe90-01bf-4f70-b183-28e24ce3a255"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "TimeRange",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Number of successful logons per machine",
                  "PartSubTitle": "Week Over Week",
                  "Query": "SecurityEvent\n| where EventID == 4624\n| where TimeGenerated >= ago(14d)\n| summarize Current_Week = countif(TimeGenerated >= ago(7d)), Previous_Week = countif(TimeGenerated < ago(7d)) by Computer\n| extend Per = iff(Current_Week > Previous_Week, toreal(Current_Week) / Previous_Week, toreal(Previous_Week) / Current_Week)\n| extend sign = iff(Current_Week > Previous_Week, \"+\", \"-\")\n| extend Percentage = iff(Current_Week != 0 and Previous_Week != 0 and Previous_Week != Current_Week, strcat(sign, extract(@\"(\\d*(\\.\\d{1,2}|$))\", 1, tostring((Per -1 )*100)), \"%\"), \"No Percentage - 0\")\n| project Computer, Previous_Week, Current_Week, Percentage"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              },
              "filters": {
                "MsPortalFx_TimeRange": {
                  "model": {
                    "format": "local",
                    "granularity": "auto",
                    "relative": "30d"
                  }
                }
              }
            }
          },
          "16": {
            "position": {
              "x": 7,
              "y": 18,
              "colSpan": 4,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\r\n| where AccountType == \"Machine\" and EventID == 4624\r\n| summarize AccountsNum = dcount(Account) by Computer\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "875239c9-e943-4734-857a-cbb3fea8079d"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Number of accounts successfully logged on",
                  "PartSubTitle": "Per machine",
                  "Query": "SecurityEvent\n| where AccountType == \"Machine\" and EventID == 4624\n| summarize AccountsNum = dcount(Account) by Computer\n| sort by AccountsNum \n| take 50\n| project Computer, Accounts = AccountsNum \n"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "17": {
            "position": {
              "x": 11,
              "y": 18,
              "colSpan": 3,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "SecurityEvent\n| where EventID in (4624, 4625)\n| where AccountType == \"Machine\"\n| summarize Amount = count() by  LogonTypeName\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "e409bb01-5776-4be7-ae39-d6acc04d7b3d"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "Contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Machine logons by type",
                  "PartSubTitle": "-"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          },
          "18": {
            "position": {
              "x": 14,
              "y": 18,
              "colSpan": 13,
              "rowSpan": 5
            },
            "metadata": {
              "inputs": [
                {
                  "name": "ComponentId",
                  "value": {
                    "SubscriptionId": "Subscription_ID",
                    "ResourceGroup": "Resource_Group_Name",
                    "Name": "Workspace_Name"
                  }
                },
                {
                  "name": "Query",
                  "value": "let FailureReasons = datatable (FailureReason:string, FailureReasonInfo:string)\r\n[\r\n    \"%%2305\", \"Account has expired.\",\r\n    \"%%2309\", \"Password has expired.\",\r\n    \"%%2310\", \"Disabled account currently disabled.\",\r\n    \"%%2311\", \"Account logon time restriction violation.\",\r\n    \"%%2312\" ,\"User not allowed to logon at this computer.\",\r\n    \"%%2313\", \"Unknown user name or bad password.\"\r\n];\r\nSecurityEvent\r\n| where EventID == 4625\r\n| join kind=leftouter (FailureReasons) on FailureReason\r\n| summarize count() by FailureReasonInfo, Computer\r\n| evaluate pivot(FailureReasonInfo, sum(count_))\r\n"
                },
                {
                  "name": "TimeRange",
                  "value": "P1D"
                },
                {
                  "name": "Version",
                  "value": "1.0"
                },
                {
                  "name": "DashboardId",
                  "value": "/subscriptions/Subscription_ID/resourceGroups/dashboards/providers/Microsoft.Portal/dashboards/580c6d17-7324-431b-a634-f6ee18d4a1a1"
                },
                {
                  "name": "PartId",
                  "value": "e4278d18-baec-4322-965b-d1b441400011"
                },
                {
                  "name": "PartTitle",
                  "value": "Analytics"
                },
                {
                  "name": "PartSubTitle",
                  "value": "contoso77"
                },
                {
                  "name": "resourceTypeMode",
                  "value": "workspace"
                },
                {
                  "name": "ControlType",
                  "value": "AnalyticsGrid"
                },
                {
                  "name": "Dimensions",
                  "isOptional": true
                },
                {
                  "name": "SpecificChart",
                  "isOptional": true
                }
              ],
              "type": "Extension/AppInsightsExtension/PartType/AnalyticsPart",
              "settings": {
                "content": {
                  "PartTitle": "Failed reasons per machine",
                  "PartSubTitle": "-",
                  "Query": "SecurityEvent\n| where EventID == 4625\n| extend Reason = case(                         SubStatus == '0xc0000064', 'User name does not exist',                         SubStatus == '0xc000005e', 'No logon servers available to service the logon request',                         SubStatus == '0xc0000062', 'Account name is not properly formatted',                         SubStatus == '0xc0000064', 'Account name does not exist',                         SubStatus == '0xc000006a', 'Incorrect password',                         SubStatus == '0xc000006d', 'Bad user name or password',                         SubStatus == '0xc000006f', 'User logon blocked by account restriction',                         SubStatus == '0xc000006f', 'User logon outside of restricted logon hours',                         SubStatus == '0xc0000070', 'User logon blocked by workstation restriction',                         SubStatus == '0xc0000071', 'Password has expired',                         SubStatus == '0xc0000072', 'Account is disabled',                         SubStatus == '0xc0000133', 'Clocks between DC and other computer too far out of sync',                         SubStatus == '0xc000015b', 'The user has not been granted the requested logon right at this machine',                         SubStatus == '0xc0000193', 'Account has expirated',                         SubStatus == '0xc0000224', 'User is required to change password at next logon',                         SubStatus == '0xc0000234', 'Account is currently locked out',                         strcat('Unknown reason substatus: ', SubStatus))\n| summarize count() by Reason, Computer\n| evaluate pivot(Reason, sum(count_))"
                }
              },
              "asset": {
                "idInputName": "ComponentId",
                "type": "ApplicationInsights"
              }
            }
          }
        }
      }
    }
  },
  "apiVersion": "2015-08-01-preview"
}