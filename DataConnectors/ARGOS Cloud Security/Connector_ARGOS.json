{
    "id": "ARGOSCloudSecurity",
    "title": "ARGOS Cloud Security",
    "publisher": "ARGOS Cloud Security",
    "descriptionMarkdown": "The ARGOS Cloud Security integration for Microsoft Sentinel allows you to have all your important cloud security events in one place. This enables you to easily create dashboards, alerts, and correlate events across multiple systems. Overall this will improve your organization's security posture and security incident response.",
    "graphQueries": [
        {
            "metricName": "Total data received",
            "legend": "ARGOS_CL",
            "baseQuery": "ARGOS_CL"
        }
    ],
    "sampleQueries": [
        {
            "description" : "Display all exploitable ARGOS Detections.",
            "query": "ARGOS_CL\n | where exploitable_b"
        },
        {
            "description" : "Display all open, exploitable ARGOS Detections on Azure.",
            "query": "ARGOS_CL\n | where exploitable_b and cloud_s == 'azure' and status_s == 'open'"
        },
        {
            "description" : "Display all open, exploitable ARGOS Detections on Azure.",
            "query": "ARGOS_CL\n | where exploitable_b and cloud_s == 'azure' and status_s == 'open'\n | sorty by "
        },
        {
            "description" : "Display all open, exploitable ARGOS Detections on Azure.",
            "query": "ARGOS_CL | where cloud_s == 'azure' and status_s == 'open'\n | summarize count() by TimeGenerated\n | render timechart "
        }
    ],
    "dataTypes": [
        {
            "name": "ARGOS_CL",
            "lastDataReceivedQuery": "ARGOS_CL\n            | summarize Time = max(TimeGenerated)\n            | where isnotempty(Time)"
        }
    ],
    "connectivityCriterias": [
        {
            "type": "IsConnectedQuery",
            "value": [
                "ARGOS_CL\n            | summarize LastLogReceived = max(TimeGenerated)\n            | project IsConnected = LastLogReceived > ago(30d)"
            ]
        }
    ],
    "availability": {
        "status": 1,
        "isPreview": true
    },
    "permissions": {
        "resourceProvider": [
            {
                "provider": "Microsoft.OperationalInsights/workspaces",
                "permissionsDisplayText": "read and write permissions are required.",
                "providerDisplayName": "Workspace",
                "scope": "Workspace",
                "requiredPermissions": {
                    "write": true,
                    "read": true,
                    "delete": true
                }
            },
            {
                "provider": "Microsoft.OperationalInsights/workspaces/sharedKeys",
                "permissionsDisplayText": "read permissions to shared keys for the workspace are required. [See the documentation to learn more about workspace keys](https://docs.microsoft.com/azure/azure-monitor/platform/agent-windows#obtain-workspace-id-and-key).",
                "providerDisplayName": "Keys",
                "scope": "Workspace",
                "requiredPermissions": {
                    "action": true
                }
            }
        ]
    },
    "instructionSteps": [
        {
            "title": "1. Subscribe to ARGOS",
            "description": "Ensure you already own an ARGOS Subscription. If not, browse to [ARGOS Cloud Security](https://argos-security.io) and sign up to ARGOS.\n\nAlternatively, you can also purchase ARGOS via the [Azure Marketplace](https://azuremarketplace.microsoft.com/en-au/marketplace/apps/argoscloudsecurity1605618416175.argoscloudsecurity?tab=Overview)."
        },
        {
            "title": "2. Configure Sentinel integration from ARGOS",
            "description": "Configure ARGOS to forward any new detections to your Sentinel workspace by providing ARGOS with your Workspace ID and Primary Key.\n\nThere is no need to deploy any custom infrastructure.\n\nEnter the information into the [ARGOS Sentinel](https://app.argos-security.io/account/sentinel) configuration page.\n\nNew detections will automatically be forwarded.\n\n[Learn more >](hhttps://www.argos-security.io/resources#integrations)",
            "instructions": [
                {
                    "parameters": {
                        "fillWith": [
                            "WorkspaceId"
                        ],
                        "label": "Workspace ID"
                    },
                    "type": "CopyableLabel"
                },
                {
                    "parameters": {
                        "fillWith": [
                            "PrimaryKey"
                        ],
                        "label": "Primary Key"
                    },
                    "type": "CopyableLabel"
                }
            ]
        }
    ],
    "metadata": {
        "id": "Unique Identifier (GUID) used to identify dependencies and content from solutions or community.",
        "version": "This is an optional field. Default and recommended format for kind value as **community or solutions** is string eg. \"1.0.0\" aligning with solutions which makes it easier to manage the content. Whereas, for kind value as **sourceRepository** the recommended format is numeric (eg. 1, 1.0,1.0.0, etc) aligning to ARM template best practices.",
        "kind": "dataConnector",
        "source": {
            "kind": "source type of the content. Value must be one of these : localWorkspace | community | solution | sourceRepository",
            "name": "Name of the content source. The repo name, solution name, LA workspace name etc."
        },
        "author": {
            "name": "Name of the author. For localWorkspace it is automatically the workspace user"
        },
        "support": {
            "tier": "Type of support for content item: microsoft | developer | community",
            "name": "Name of support contact or company",
            "email": "Optional: Email of support contact",
            "link":"Optional: Link for support help, like to support page to open a ticket etc"
        }
    }
}
