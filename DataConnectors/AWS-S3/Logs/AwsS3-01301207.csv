"Time","Message","Severity"
"1/30/2022 12:07 PM","Starting ConfigAwsConnector at: 01/30/2022 12:07:04","Information"
"1/30/2022 12:07 PM","Log created: C:\One\ASI\Azure-Sentinel\DataConnectors\AWS-S3\Logs\AwsS3-01301207.csv","Information"
"1/30/2022 12:07 PM","To begin you will choose the AWS logs to configure.","Information"
"1/30/2022 12:07 PM","Checking AWS CLI configuration...","Information"
"1/30/2022 12:07 PM","Starting Vpc flow data connector configuration script","Verbose"
"1/30/2022 12:07 PM","This script creates an Assume Role with minimal permissions to grant Azure Sentinel access to your logs in a designated S3 bucket & SQS of your choice, enable VPCFlow Logs, S3 bucket, SQS Queue, and S3 notifications.","Information"
"1/30/2022 12:07 PM","Notes:","Information"
"1/30/2022 12:07 PM","* You can find more information about the script in https://github.com/Azure/Azure-Sentinel/blob/master/DataConnectors/AWS-S3/README.md","Information"
"1/30/2022 12:07 PM","* If a resource name(like: S3, Sqs, Kms) already exists, the script will use the available one and not create a new resource","Information"
"1/30/2022 12:07 PM","Assume role definition","Information"
"1/30/2022 12:07 PM","Executing Set-RetryAction","Verbose"
"1/30/2022 12:07 PM","Using role name: testScript","Information"
"1/30/2022 12:07 PM","Executing: aws iam get-role --role-name testScript 2>&1| Out-Null","Verbose"
"1/30/2022 12:07 PM","Executing: aws iam get-role --role-name testScript","Verbose"
"1/30/2022 12:07 PM","arn:aws:iam::072643944673:role/testScript","Verbose"
"1/30/2022 12:07 PM","Using S3 Bucket name: testScript","Information"
"1/30/2022 12:07 PM","current region configuration: eu-central-1","Verbose"
"1/30/2022 12:07 PM","Executing: aws s3api head-bucket --bucket testScript 2>&1","Verbose"
"1/30/2022 12:07 PM","Executing: aws s3api create-bucket --bucket testScript --create-bucket-configuration LocationConstraint=eu-central-1 2>&1","Verbose"
"1/30/2022 12:07 PM","System.Management.Automation.RemoteException An error occurred (InvalidBucketName) when calling the CreateBucket operation: The specified bucket is not valid.","Verbose"
"1/30/2022 12:07 PM","Please see AWS bucket name documentation https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudtrail-s3-bucket-naming-requirements.html","Error"
"1/30/2022 12:07 PM","An error occurred (InvalidBucketName) when calling the CreateBucket operation: The specified bucket is not valid.","Error"
"1/30/2022 12:07 PM","Retrying...","Information"
"1/30/2022 12:07 PM","Using S3 Bucket name: testscriptdaniel12","Information"
"1/30/2022 12:07 PM","current region configuration: eu-central-1","Verbose"
"1/30/2022 12:07 PM","Executing: aws s3api head-bucket --bucket testscriptdaniel12 2>&1","Verbose"
"1/30/2022 12:07 PM","Executing: aws s3api create-bucket --bucket testscriptdaniel12 --create-bucket-configuration LocationConstraint=eu-central-1 2>&1","Verbose"
"1/30/2022 12:07 PM","{     ""Location"": ""http://testscriptdaniel12.s3.amazonaws.com/"" }","Verbose"
"1/30/2022 12:07 PM","S3 Bucket testscriptdaniel12 created successfully","Information"
"1/30/2022 12:07 PM","Executing: aws s3api put-bucket-tagging --bucket testscriptdaniel12 --tagging  ""{\""TagSet\"":[{\""Key\"": \""Operator\"", \""Value\"": \""Microsoft_Sentinel_Automation_Script\""}]}""","Verbose"
"1/30/2022 12:07 PM","Executing: (aws sts get-caller-identity | ConvertFrom-Json).Account","Verbose"
"1/30/2022 12:07 PM","072643944673","Verbose"
"1/30/2022 12:07 PM","Executing: (aws sts get-caller-identity | ConvertFrom-Json).Account","Verbose"
"1/30/2022 12:07 PM","072643944673","Verbose"
"1/30/2022 12:07 PM","Listing your available VPC IDs","Information"
"1/30/2022 12:07 PM","Executing: aws ec2 --output text --query 'Vpcs[*].{VpcId:VpcId}' describe-vpcs","Verbose"
"1/30/2022 12:07 PM","Enabling VPC flow Logs (default format)","Information"
