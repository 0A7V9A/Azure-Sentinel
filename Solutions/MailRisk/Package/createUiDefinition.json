{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "config": {
            "basics": {
                "description": "<img src=\"https://raw.githubusercontent.com/Azure/Azure-Sentinel/master/Logos/securepractice_logo.svg\" width=\"75px\" height=\"75px\">\n\nThe [MailRisk by Secure Practice](https://securepractice.co/) solution for Microsoft Sentinel enables you to ingest email reported with the MailRisk plugin into Microsoft Sentinel Log Analytics."
            }
        },
        "resourceTypes": [
            "microsoft.keyvault/vaults",
            "microsoft.insights/components",
            "microsoft.storage/storageaccounts",
            "microsoft.web/serverfarms",
            "microsoft.web/sites",
            "microsoft.resources/resourcegroups"
        ],
        "basics": [
            {
                "name": "FunctionName",
                "type": "Microsoft.Common.TextBox",
                "label": "Function Name",
                "defaultValue": "MailRisk",
                "toolTip": "Name of the function app that will be created. Must be unique globally.",
                "constraints": {
                    "required": true,
                    "regex": "^[a-z0-9A-Z]{3,11}",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 3-11 characters long."
                },
                "visible": true
            },
            {
                "name": "WorkspaceId",
                "type": "Microsoft.Common.TextBox",
                "label": "Workspace Id",
                "defaultValue": "",
                "toolTip": "Workspace ID and Primary Key can be found in the Azure Portal, and you should find the workspace that is connected to Microsoft Sentinel. Typically found under Log Analytics workspace -> Agents management",
                "constraints": {
                    "required": true,
                    "regex": "^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}",
                    "validationMessage": "Should be on the form of a UUID (766ad7ea-b4ab-4cfe-ac50-a1a6736ff953)."
                },
                "visible": true
            },
            {
                "name": "WorkspaceKey",
                "type": "Microsoft.Common.PasswordBox",
                "label": {
                    "password": "Workspace Key",
                    "confirmPassword": "Confirm password"
                },
                "toolTip": "Workspace ID and Primary Key can be found in the Azure Portal, and you should find the workspace that is connected to Microsoft Sentinel. Typically found under Log Analytics workspace -> Agents management",
                "constraints": {
                    "required": true
                },
                "options": {
                    "hideConfirmation": false
                },
                "visible": true
            },
            {
                "name": "APIKey",
                "type": "Microsoft.Common.TextBox",
                "label": "API Key",
                "defaultValue": "",
                "toolTip": "The Secure Practice API key and secret are created in the <a href=\"https://manage.securepractice.co/settings/security\" target=\"_blank\">settings in the admin portal</a>.",
                "constraints": {
                    "required": true,
                    "regex": "^[a-z0-9A-Z]{24}",
                    "validationMessage": "Only alphanumeric characters are allowed, and the value must be 24 characters long."
                },
                "visible": true
            },
            {
                "name": "APISecret",
                "type": "Microsoft.Common.PasswordBox",
                "label": {
                    "password": "API Secret",
                    "confirmPassword": "Confirm password"
                },
                "toolTip": "The Secure Practice API key and secret are created in the <a href=\"https://manage.securepractice.co/settings/security\" target=\"_blank\">settings in the admin portal</a>.",
                "constraints": {
                    "required": true
                },
                "options": {
                    "hideConfirmation": false
                },
                "visible": true
            }
        ],
        "steps": [],
        "outputs": {
            "location": "[location()]",
            "FunctionName": "[basics('FunctionName')]",
            "WorkspaceId": "[basics('WorkspaceId')]",
            "WorkspaceKey": "[basics('WorkspaceKey')]",
            "APIKey": "[basics('APIKey')]",
            "APISecret": "[basics('APISecret')]"
        }
    }
}