// Usage Instruction : 
// Paste below query in log analytics, click on Save button and select as Function from drop down by specifying function name and alias as imDNSGCPCloudDNS.
// Function usually takes 10-15 minutes to activate. You can then use function alias from any other queries (e.g. imDNSGCPCloudDNS | take 10).
// Reference : Using functions in Azure monitor log queries : https://docs.microsoft.com/azure/azure-monitor/log-query/functions
GCP_DNS_CL
| extend EventVendor = 'GCP'
| extend EventProduct = 'Cloud DNS'
| project-rename EventOriginalUid=insert_id_s,
    EventSeverity=severity_s,
    EventEndTime=timestamp_t,
    EventType=resource_type_s,
    NetworkProtocol=payload_protocol_s,
    QueryTypeName=payload_queryType_s,
    ResponseName=payload_rdata_s,
    ResponseCodeName=payload_responseCode_s,
    Query=payload_queryName_s,
    SrcIpAddr=payload_sourceIP_s
