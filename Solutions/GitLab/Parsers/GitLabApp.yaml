id: c932d92d-456f-4677-a364-284b2e376832
Function:
  Title: Parser for GitLabApp
  Version: '1.0.0'
  LastUpdated: '2023-08-08'
Category: Microsoft Sentinel Parser
FunctionName: GitLabApp
FunctionAlias: GitLabApp
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'GitLab-Application-Logs'
    | extend parsedMessage = parse_json(SyslogMessage)
    | project TimeGenerated, 
      Severity = parsedMessage.severity,
      Computer,
      HostName,
      HostIP,
      EventTime = todatetime(parsedMessage.['time']),
      CorrelationID = parsedMessage.correlation_id,
      Message = parsedMessage.message,
      FailedLogin = iff(parsedMessage hasprefix_cs "Failed Login",1,0),
      UserAdded = iff(parsedMessage hassuffix_cs "was created",1,0),
      UserImpersonated = iff(parsedMessage matches regex ".*impersonating.*",1,0)