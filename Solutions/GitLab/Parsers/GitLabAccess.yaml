id: c2e79ab4-ada2-47bb-9378-ba4496ef6c79
Function:
  Title: Parser for GitLabAccess
  Version: '1.0.0'
  LastUpdated: '2023-08-03'
Category: Microsoft Sentinel Parser
FunctionName: GitLabAccess
FunctionAlias: GitLabAccess
FunctionParams:
FunctionQuery: |
    Syslog
    | where Facility == 'local7'
    | where ProcessName == 'GitLab-Access-Logs'
    | where SyslogMessage has_any ("GET","POST","PUT","DELETE","PATCH") and SyslogMessage contains "HTTP"
    | parse SyslogMessage with IPAddress " - - [" EventTime "] \"" RequestVerb " " URI " " HTTPVersion "\"" ResponseCode " " BytesSent "\"" HTTPReferer "\" \"" UserAgent
    | project TimeGenerated, EventTime = todatetime(EventTime), IPAddress, RequestVerb, URI, HTTPVersion, ResponseCode, BytesSent, HTTPReferer, UserAgent