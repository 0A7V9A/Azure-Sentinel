{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "dataCollectionRules_CrowdStrikeCustomDCR_name": {
      "defaultValue": "CrowdStrikeRawDataDCR",
      "type": "String"
    },
    "dataCollectionEndpoints_TestCustomCrowdstrikeDCE_externalid": {
      "defaultValue": "/subscriptions/4383ac89-7cd1-48c1-8061-b0b3c5ccfd97/resourceGroups/rg-networksolution/providers/Microsoft.Insights/dataCollectionEndpoints/TestCustomCrowdstrikeDCE",
      "type": "String"
    },
    "workspaces_TestNetworkSolution_externalid": {
      "defaultValue": "/subscriptions/4383ac89-7cd1-48c1-8061-b0b3c5ccfd97/resourceGroups/rg-networksolution/providers/Microsoft.OperationalInsights/workspaces/TestNetworkSolution",
      "type": "String"
    }
  },
  "variables": {},
  "resources": [
    {
      "type": "Microsoft.Insights/dataCollectionRules",
      "apiVersion": "2022-06-01",
      "name": "[parameters('dataCollectionRules_CrowdStrikeCustomDCR_name')]",
      "location": "westus",
      "properties": {
        "dataCollectionEndpointId": "[parameters('dataCollectionEndpoints_TestCustomCrowdstrikeDCE_externalid')]",
        "streamDeclarations": {
          "Custom-CrowdstrikeDns": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "DomainName",
                "type": "string"
              },
              {
                "name": "RequestType",
                "type": "string"
              },
              {
                "name": "IP4Records",
                "type": "string"
              },
              {
                "name": "QueryStatus",
                "type": "string"
              },
              {
                "name": "FirstIP4Record",
                "type": "string"
              },
              {
                "name": "DnsRequestCount",
                "type": "long"
              },
              {
                "name": "IP6Records",
                "type": "string"
              },
              {
                "name": "InterfaceIndex",
                "type": "long"
              },
              {
                "name": "DualRequest",
                "type": "string"
              },
              {
                "name": "DnsResponseType",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "RespondingDnsServer",
                "type": "string"
              },
              {
                "name": "CNAMERecords",
                "type": "string"
              },
              {
                "name": "FirstIP6Record",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeAuth": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "LogonType",
                "type": "string"
              },
              {
                "name": "LogonTime",
                "type": "real"
              },
              {
                "name": "UserIsAdmin",
                "type": "string"
              },
              {
                "name": "LogonDomain",
                "type": "string"
              },
              {
                "name": "RemoteAccount",
                "type": "string"
              },
              {
                "name": "ClientComputerName",
                "type": "string"
              },
              {
                "name": "UserPrincipal",
                "type": "string"
              },
              {
                "name": "RawProcessId",
                "type": "string"
              },
              {
                "name": "UserSid",
                "type": "string"
              },
              {
                "name": "LogonServer",
                "type": "string"
              },
              {
                "name": "AuthenticationPackage",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "UserLogonFlags",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "UserLogoffType",
                "type": "string"
              },
              {
                "name": "LogoffTime",
                "type": "real"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "UserFlags",
                "type": "string"
              },
              {
                "name": "PrivilegesBitmask",
                "type": "string"
              },
              {
                "name": "PasswordLastSet",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "TargetProcessId",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "EtwRawProcessId",
                "type": "string"
              },
              {
                "name": "EtwRawThreadId",
                "type": "long"
              },
              {
                "name": "SubStatus",
                "type": "string"
              },
              {
                "name": "LocalSession",
                "type": "string"
              },
              {
                "name": "EnabledPrivilegesBitmask",
                "type": "string"
              },
              {
                "name": "UserGroupsBitmask",
                "type": "string"
              },
              {
                "name": "LinkedAuthenticationId",
                "type": "string"
              },
              {
                "name": "UserCanonical",
                "type": "string"
              },
              {
                "name": "LoginSessionId",
                "type": "string"
              },
              {
                "name": "AuthenticationUuidAsString",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "AuthenticationUuid",
                "type": "string"
              },
              {
                "name": "AuthenticationIdMac",
                "type": "string"
              },
              {
                "name": "ResendToCloud",
                "type": "string"
              },
              {
                "name": "LogonId",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeFile": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "FileOperatorSid",
                "type": "string"
              },
              {
                "name": "Size",
                "type": "long"
              },
              {
                "name": "FileWrittenFlags",
                "type": "string"
              },
              {
                "name": "OperationFlags",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "SourceFileName",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "OriginalFilename",
                "type": "string"
              },
              {
                "name": "ClientId",
                "type": "string"
              },
              {
                "name": "TargetDirectoryName",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "IsOnRemovableDisk",
                "type": "string"
              },
              {
                "name": "MinorFunction",
                "type": "string"
              },
              {
                "name": "IsOnNetwork",
                "type": "string"
              },
              {
                "name": "FileIdentifier",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "DiskParentDeviceInstanceId",
                "type": "string"
              },
              {
                "name": "FileObject",
                "type": "string"
              },
              {
                "name": "IrpFlags",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "FileEcpBitmask",
                "type": "string"
              },
              {
                "name": "MajorFunction",
                "type": "string"
              },
              {
                "name": "TemporaryFileName",
                "type": "string"
              },
              {
                "name": "VolumeSessionUUID",
                "type": "string"
              },
              {
                "name": "PatternId",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "MSOfficeSubType",
                "type": "string"
              },
              {
                "name": "GID",
                "type": "string"
              },
              {
                "name": "UnixMode",
                "type": "string"
              },
              {
                "name": "USN",
                "type": "string"
              },
              {
                "name": "FileCategory",
                "type": "string"
              },
              {
                "name": "ShareAccess",
                "type": "string"
              },
              {
                "name": "DesiredAccess",
                "type": "string"
              },
              {
                "name": "ELFSubType",
                "type": "string"
              },
              {
                "name": "IsTransactedFile",
                "type": "string"
              },
              {
                "name": "MachOSubType",
                "type": "string"
              },
              {
                "name": "VnodeModificationType",
                "type": "string"
              },
              {
                "name": "NewFileIdentifier",
                "type": "string"
              },
              {
                "name": "Options",
                "type": "string"
              },
              {
                "name": "Information",
                "type": "string"
              },
              {
                "name": "FileAttributes",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "FixedFileVersion",
                "type": "string"
              },
              {
                "name": "HandleCreateAuthenticationId",
                "type": "string"
              },
              {
                "name": "VnodeType",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeNetwork": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "ConnectionDirection",
                "type": "string"
              },
              {
                "name": "RemotePort",
                "type": "long"
              },
              {
                "name": "LocalAddressIP6",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "LocalPort",
                "type": "long"
              },
              {
                "name": "Protocol",
                "type": "string"
              },
              {
                "name": "RemoteAddressString",
                "type": "string"
              },
              {
                "name": "FirewallAction",
                "type": "string"
              },
              {
                "name": "NegateLocalAddress",
                "type": "string"
              },
              {
                "name": "RemoteAddressMaskIP6",
                "type": "string"
              },
              {
                "name": "LocalAddressMaskIP6",
                "type": "string"
              },
              {
                "name": "NegateRemoteAddress",
                "type": "string"
              },
              {
                "name": "IcmpCode",
                "type": "string"
              },
              {
                "name": "IcmpType",
                "type": "string"
              },
              {
                "name": "LocalAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "RemoteAddressMaskIP4",
                "type": "string"
              },
              {
                "name": "LocalAddressMaskIP4",
                "type": "string"
              },
              {
                "name": "PhysicalAddress",
                "type": "string"
              },
              {
                "name": "ConnectionFlags",
                "type": "string"
              },
              {
                "name": "InContext",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "InterfaceIndex",
                "type": "long"
              },
              {
                "name": "NetLuidIndex",
                "type": "long"
              },
              {
                "name": "NeighborList",
                "type": "string"
              },
              {
                "name": "TcpConnectErrorCode",
                "type": "string"
              },
              {
                "name": "InterfaceAlias",
                "type": "string"
              },
              {
                "name": "NegateInterface",
                "type": "string"
              },
              {
                "name": "IsUnique",
                "type": "string"
              },
              {
                "name": "LocalPortRangeStart",
                "type": "string"
              },
              {
                "name": "LocalPortRangeOperation",
                "type": "string"
              },
              {
                "name": "RemotePortRangeOperation",
                "type": "string"
              },
              {
                "name": "RemotePortRangeStart",
                "type": "string"
              },
              {
                "name": "HbfwRuleId",
                "type": "string"
              },
              {
                "name": "NetworkProfile",
                "type": "string"
              },
              {
                "name": "PolicyIdentifier",
                "type": "string"
              },
              {
                "name": "HbfwRuleFlags",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "RuleAction",
                "type": "string"
              },
              {
                "name": "RuleMatchCount",
                "type": "long"
              },
              {
                "name": "RuleMatchCountSinceLastReport",
                "type": "long"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeProcess": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "UserSid",
                "type": "string"
              },
              {
                "name": "ParentBaseFileName",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "MD5HashData",
                "type": "string"
              },
              {
                "name": "SHA1HashData",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "InjecteeImageFileName",
                "type": "string"
              },
              {
                "name": "InjectorImageFileName",
                "type": "string"
              },
              {
                "name": "IntegrityLevel",
                "type": "string"
              },
              {
                "name": "ParentProcessId",
                "type": "string"
              },
              {
                "name": "TargetProcessId",
                "type": "string"
              },
              {
                "name": "ConHostProcessId",
                "type": "string"
              },
              {
                "name": "WritingProcessId",
                "type": "string"
              },
              {
                "name": "SourceProcessId",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "WritingProcessImageFileName",
                "type": "string"
              },
              {
                "name": "WritingProcessCommandLine",
                "type": "string"
              },
              {
                "name": "OriginalFilename",
                "type": "string"
              },
              {
                "name": "ProcessStartTime",
                "type": "real"
              },
              {
                "name": "ProcessEndTime",
                "type": "real"
              },
              {
                "name": "ModuleName",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "ParentCommandLine",
                "type": "string"
              },
              {
                "name": "TemplateInstanceId",
                "type": "string"
              },
              {
                "name": "ParentImageFileName",
                "type": "string"
              },
              {
                "name": "PatternId",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "ProcessGroupId",
                "type": "string"
              },
              {
                "name": "RawProcessId",
                "type": "string"
              },
              {
                "name": "SyntheticPR2Flags",
                "type": "string"
              },
              {
                "name": "ImageSubsystem",
                "type": "string"
              },
              {
                "name": "SourceThreadId",
                "type": "string"
              },
              {
                "name": "AuthenticodeHashData",
                "type": "string"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "ParentAuthenticationId",
                "type": "string"
              },
              {
                "name": "SignInfoFlags",
                "type": "string"
              },
              {
                "name": "CallStackModuleNamesVersion",
                "type": "string"
              },
              {
                "name": "CsaProcessDataCollectionInstanceId",
                "type": "string"
              },
              {
                "name": "CallStackModuleNames",
                "type": "string"
              },
              {
                "name": "CreateProcessType",
                "type": "string"
              },
              {
                "name": "ZoneIdentifier",
                "type": "string"
              },
              {
                "name": "HostUrl",
                "type": "string"
              },
              {
                "name": "TargetThreadId",
                "type": "string"
              },
              {
                "name": "SignatureErrorState",
                "type": "string"
              },
              {
                "name": "ModuleCharacteristics",
                "type": "string"
              },
              {
                "name": "PublicKeys",
                "type": "string"
              },
              {
                "name": "ExtendedKeyUsages",
                "type": "string"
              },
              {
                "name": "SignatureState",
                "type": "string"
              },
              {
                "name": "MappedFromUserMode",
                "type": "string"
              },
              {
                "name": "FileSigningTime",
                "type": "real"
              },
              {
                "name": "Certificate",
                "type": "string"
              },
              {
                "name": "FileIdentifier",
                "type": "string"
              },
              {
                "name": "ExecutableBytes",
                "type": "string"
              },
              {
                "name": "LoadingProcessOriginalFilename",
                "type": "string"
              },
              {
                "name": "ModuleTagsAsString",
                "type": "string"
              },
              {
                "name": "ImageDirectoryClassification",
                "type": "string"
              },
              {
                "name": "ParentProcessPatternIdList",
                "type": "string"
              },
              {
                "name": "ModuleLoadMechanism",
                "type": "string"
              },
              {
                "name": "PatternIdList",
                "type": "string"
              },
              {
                "name": "ScreenshotsTakenCount",
                "type": "long"
              },
              {
                "name": "ExitCode",
                "type": "string"
              },
              {
                "name": "NetworkListenCount",
                "type": "long"
              },
              {
                "name": "SuspiciousRawDiskReadCount",
                "type": "long"
              },
              {
                "name": "NetworkBindCount",
                "type": "long"
              },
              {
                "name": "NetworkRecvAcceptCount",
                "type": "long"
              },
              {
                "name": "ContextData",
                "type": "string"
              },
              {
                "name": "NewExecutableWrittenCount",
                "type": "long"
              },
              {
                "name": "ExeAndServiceCount",
                "type": "long"
              },
              {
                "name": "NetworkCloseCount",
                "type": "long"
              },
              {
                "name": "SuspectStackCount",
                "type": "long"
              },
              {
                "name": "CLICreationCount",
                "type": "long"
              },
              {
                "name": "UnsignedModuleLoadCount",
                "type": "long"
              },
              {
                "name": "UserTime",
                "type": "long"
              },
              {
                "name": "AllocateVirtualMemoryCount",
                "type": "long"
              },
              {
                "name": "ServiceEventCount",
                "type": "long"
              },
              {
                "name": "SnapshotFileOpenCount",
                "type": "long"
              },
              {
                "name": "RemovableDiskFileWrittenCount",
                "type": "long"
              },
              {
                "name": "InjectedDllCount",
                "type": "long"
              },
              {
                "name": "ModuleLoadCount",
                "type": "long"
              },
              {
                "name": "UserMemoryProtectExecutableCount",
                "type": "long"
              },
              {
                "name": "NetworkCapableAsepWriteCount",
                "type": "long"
              },
              {
                "name": "DnsRequestCount",
                "type": "long"
              },
              {
                "name": "ArchiveFileWrittenCount",
                "type": "long"
              },
              {
                "name": "SetThreadContextCount",
                "type": "long"
              },
              {
                "name": "SuspiciousCredentialModuleLoadCount",
                "type": "long"
              },
              {
                "name": "FileDeletedCount",
                "type": "long"
              },
              {
                "name": "UserMemoryAllocateExecutableCount",
                "type": "long"
              },
              {
                "name": "DirectoryCreatedCount",
                "type": "long"
              },
              {
                "name": "NetworkConnectCountUdp",
                "type": "long"
              },
              {
                "name": "QueueApcCount",
                "type": "long"
              },
              {
                "name": "SuspiciousFontLoadCount",
                "type": "long"
              },
              {
                "name": "ConHostId",
                "type": "string"
              },
              {
                "name": "NetworkConnectCount",
                "type": "long"
              },
              {
                "name": "BinaryExecutableWrittenCount",
                "type": "long"
              },
              {
                "name": "CycleTime",
                "type": "long"
              },
              {
                "name": "PrivilegedProcessHandleCount",
                "type": "long"
              },
              {
                "name": "MaxThreadCount",
                "type": "long"
              },
              {
                "name": "GenericFileWrittenCount",
                "type": "long"
              },
              {
                "name": "ScriptEngineInvocationCount",
                "type": "long"
              },
              {
                "name": "RunDllInvocationCount",
                "type": "long"
              },
              {
                "name": "CreateProcessCount",
                "type": "long"
              },
              {
                "name": "KernelTime",
                "type": "long"
              },
              {
                "name": "DirectoryEnumeratedCount",
                "type": "long"
              },
              {
                "name": "AsepWrittenCount",
                "type": "long"
              },
              {
                "name": "SuspiciousDnsRequestCount",
                "type": "long"
              },
              {
                "name": "DocumentFileWrittenCount",
                "type": "long"
              },
              {
                "name": "ProtectVirtualMemoryCount",
                "type": "long"
              },
              {
                "name": "UserMemoryProtectExecutableRemoteCount",
                "type": "long"
              },
              {
                "name": "UserMemoryAllocateExecutableRemoteCount",
                "type": "long"
              },
              {
                "name": "ExecutableDeletedCount",
                "type": "long"
              },
              {
                "name": "RegKeySecurityDecreasedCount",
                "type": "long"
              },
              {
                "name": "InjectedThreadCount",
                "type": "long"
              },
              {
                "name": "NetworkModuleLoadCount",
                "type": "long"
              },
              {
                "name": "ThreadStartAddress",
                "type": "string"
              },
              {
                "name": "ThreadExecutionControlType",
                "type": "string"
              },
              {
                "name": "PayloadClassification",
                "type": "string"
              },
              {
                "name": "PayloadClassificationFlags",
                "type": "string"
              },
              {
                "name": "MemoryDescriptionFlags",
                "type": "string"
              },
              {
                "name": "WellKnownTargetFunction",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeRegistry": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "RegObjectName",
                "type": "string"
              },
              {
                "name": "RegValueName",
                "type": "string"
              },
              {
                "name": "RegClassificationFlags",
                "type": "string"
              },
              {
                "name": "RegOperationType",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "RegStringValue",
                "type": "string"
              },
              {
                "name": "RegType",
                "type": "string"
              },
              {
                "name": "RegClassificationIndex",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "RegNumericValue",
                "type": "int"
              },
              {
                "name": "RegBinaryValue",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeAudit": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "VolumeSnapshotName",
                "type": "string"
              },
              {
                "name": "SmbShareName",
                "type": "string"
              },
              {
                "name": "ShareName",
                "type": "string"
              },
              {
                "name": "UploadId",
                "type": "string"
              },
              {
                "name": "SessionId",
                "type": "string"
              },
              {
                "name": "ComputerName",
                "type": "string"
              },
              {
                "name": "FirewallRule",
                "type": "string"
              },
              {
                "name": "FirewallRuleId",
                "type": "string"
              },
              {
                "name": "FirewallOption",
                "type": "string"
              },
              {
                "name": "SourceFileName",
                "type": "string"
              },
              {
                "name": "TargetFileName",
                "type": "string"
              },
              {
                "name": "DeviceVendorId",
                "type": "string"
              },
              {
                "name": "DeviceProductId",
                "type": "string"
              },
              {
                "name": "DeviceSerialNumber",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceAddress",
                "type": "string"
              },
              {
                "name": "EnvironmentVariableName",
                "type": "string"
              },
              {
                "name": "SamAccountName",
                "type": "string"
              },
              {
                "name": "FirewallOptionNumericValue",
                "type": "string"
              },
              {
                "name": "FirewallOptionStringValue",
                "type": "string"
              },
              {
                "name": "FileVaultIsEnabled",
                "type": "boolean"
              },
              {
                "name": "EnvironmentVariableValue",
                "type": "string"
              },
              {
                "name": "ConfigStateData",
                "type": "string"
              },
              {
                "name": "ActiveDirectoryOuDn",
                "type": "string"
              },
              {
                "name": "ActiveDirectoryDepartment",
                "type": "string"
              },
              {
                "name": "SHA256HashData",
                "type": "string"
              },
              {
                "name": "CommandLine",
                "type": "string"
              },
              {
                "name": "VolumeName",
                "type": "string"
              },
              {
                "name": "VolumeDriveLetter",
                "type": "string"
              },
              {
                "name": "TokenType",
                "type": "string"
              },
              {
                "name": "InterfaceGuid",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "InterfaceVersion",
                "type": "string"
              },
              {
                "name": "RpcClientThreadId",
                "type": "string"
              },
              {
                "name": "AuthenticationId",
                "type": "string"
              },
              {
                "name": "ImageFileName",
                "type": "string"
              },
              {
                "name": "RpcOpNum",
                "type": "string"
              },
              {
                "name": "RpcNestingLevel",
                "type": "string"
              },
              {
                "name": "ClientComputerName",
                "type": "string"
              },
              {
                "name": "DomainName",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP6",
                "type": "string"
              },
              {
                "name": "RemoteAddressIP4",
                "type": "string"
              },
              {
                "name": "SmbClientName",
                "type": "string"
              },
              {
                "name": "AgentLoadFlags",
                "type": "string"
              },
              {
                "name": "ProvisioningDuration",
                "type": "string"
              },
              {
                "name": "Status",
                "type": "string"
              },
              {
                "name": "ErrorText",
                "type": "string"
              },
              {
                "name": "CloudErrorCode",
                "type": "string"
              },
              {
                "name": "SharePath",
                "type": "string"
              },
              {
                "name": "ShareMaxCount",
                "type": "long"
              },
              {
                "name": "ShareRemark",
                "type": "string"
              },
              {
                "name": "ShareData",
                "type": "string"
              },
              {
                "name": "IntelTDTEnabled",
                "type": "string"
              },
              {
                "name": "FalconServiceState",
                "type": "string"
              },
              {
                "name": "LfoUploadFlags",
                "type": "string"
              },
              {
                "name": "AttemptNumber",
                "type": "long"
              },
              {
                "name": "Size",
                "type": "string"
              },
              {
                "name": "Tags",
                "type": "string"
              },
              {
                "name": "CloudRequestId",
                "type": "string"
              },
              {
                "name": "LocalSession",
                "type": "string"
              },
              {
                "name": "IOServiceClass",
                "type": "string"
              },
              {
                "name": "IOServicePath",
                "type": "string"
              },
              {
                "name": "IOServiceProperties",
                "type": "string"
              },
              {
                "name": "IOServiceName",
                "type": "string"
              },
              {
                "name": "Protocol",
                "type": "string"
              },
              {
                "name": "ChannelDiffStatusList",
                "type": "string"
              },
              {
                "name": "AccountDomain",
                "type": "string"
              },
              {
                "name": "AccountObjectGuid",
                "type": "string"
              },
              {
                "name": "AccountObjectSid",
                "type": "string"
              },
              {
                "name": "TotalCount",
                "type": "long"
              },
              {
                "name": "ErrorCode",
                "type": "string"
              },
              {
                "name": "EventOrigin",
                "type": "string"
              },
              {
                "name": "AddressFamily",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceType",
                "type": "string"
              },
              {
                "name": "DeviceTimeStamp",
                "type": "real"
              },
              {
                "name": "DeviceInstanceId",
                "type": "string"
              },
              {
                "name": "BluetoothDeviceAddressType",
                "type": "string"
              },
              {
                "name": "DeviceVersion",
                "type": "string"
              },
              {
                "name": "DeviceDescriptorSetHash",
                "type": "string"
              },
              {
                "name": "DeviceManufacturer",
                "type": "string"
              },
              {
                "name": "DeviceProduct",
                "type": "string"
              },
              {
                "name": "DeviceUserSid",
                "type": "string"
              },
              {
                "name": "DeviceUserAuthenticationId",
                "type": "string"
              },
              {
                "name": "FirewallProfile",
                "type": "string"
              },
              {
                "name": "ShareAccess",
                "type": "string"
              },
              {
                "name": "DesiredAccess",
                "type": "string"
              },
              {
                "name": "GID",
                "type": "string"
              },
              {
                "name": "UID",
                "type": "string"
              },
              {
                "name": "UnixMode",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          },
          "Custom-CrowdstrikeUser": {
            "columns": [
              {
                "name": "event_simpleName",
                "type": "string"
              },
              {
                "name": "timestamp",
                "type": "long"
              },
              {
                "name": "aip",
                "type": "string"
              },
              {
                "name": "aid",
                "type": "string"
              },
              {
                "name": "UserName",
                "type": "string"
              },
              {
                "name": "event_platform",
                "type": "string"
              },
              {
                "name": "ContextTimeStamp",
                "type": "real"
              },
              {
                "name": "name",
                "type": "string"
              },
              {
                "name": "ConfigBuild",
                "type": "string"
              },
              {
                "name": "id",
                "type": "string"
              },
              {
                "name": "ConfigStateHash",
                "type": "string"
              },
              {
                "name": "ContextProcessId",
                "type": "string"
              },
              {
                "name": "ContextThreadId",
                "type": "string"
              },
              {
                "name": "BoundingLimitCount",
                "type": "long"
              },
              {
                "name": "BoundingLimitDuration",
                "type": "string"
              },
              {
                "name": "Entitlements",
                "type": "string"
              },
              {
                "name": "EffectiveTransmissionClass",
                "type": "string"
              },
              {
                "name": "cid",
                "type": "string"
              },
              {
                "name": "OciContainerId",
                "type": "string"
              },
              {
                "name": "TreeId",
                "type": "string"
              },
              {
                "name": "UserRid",
                "type": "string"
              },
              {
                "name": "GroupRid",
                "type": "string"
              },
              {
                "name": "InterfaceVersion",
                "type": "string"
              },
              {
                "name": "RpcClientThreadId",
                "type": "string"
              },
              {
                "name": "RpcOpNum",
                "type": "string"
              },
              {
                "name": "InterfaceGuid",
                "type": "string"
              },
              {
                "name": "RpcClientProcessId",
                "type": "string"
              },
              {
                "name": "RpcNestingLevel",
                "type": "string"
              },
              {
                "name": "DomainSid",
                "type": "string"
              },
              {
                "name": "AdditionalFields",
                "type": "dynamic"
              }
            ]
          }
        },
        "destinations": {
          "logAnalytics": [
            {
              "workspaceResourceId": "[parameters('workspaces_TestNetworkSolution_externalid')]",
              "name": "myworkspace"
            }
          ]
        },
        "dataFlows": [
          {
            "streams": ["Custom-CrowdstrikeNetwork"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_Network_Events_2_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeDns"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_DNS_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeFile"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_File_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeAuth"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_Auth_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeProcess"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_Process_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeRegistry"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_Registry_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeAudit"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_Audit_Events_1_CL"
          },
          {
            "streams": ["Custom-CrowdstrikeUser"],
            "destinations": ["myworkspace"],
            "transformKql": "source\r\n| extend eventDatetime = datetime_add('Millisecond', tolong(timestamp), todatetime('1970-01-01'))\r\n| extend TimeGenerated = iff(isnotempty(eventDatetime), eventDatetime, now())\r\n| project-rename \r\n        CrowdStrikeId = ['id']",
            "outputStream": "Custom-CrowdStrike_User_Events_1_CL"
          }
        ]
      }
    }
  ]
}
