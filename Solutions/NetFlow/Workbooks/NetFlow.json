{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "## NetFlow\n---"
      },
      "name": "NetFlow"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "9304abcc-97a5-4fc9-b86b-04ef5883c23c",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Overview",
            "subTarget": "Overview",
            "preText": "Overview",
            "style": "link"
          },
          {
            "id": "7ed8b435-845e-4526-ad29-287ec7b11964",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Conversation Partners",
            "subTarget": "ConversationPartners",
            "style": "link"
          },
          {
            "id": "e37dc3cb-2f02-41cb-a6b2-fc91c9683481",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Traffic Analysis",
            "subTarget": "TrafficAnalysis",
            "style": "link"
          },
          {
            "id": "238c8184-68c4-4825-b21d-355f4b6cb8b2",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Top-N",
            "subTarget": "TopN",
            "style": "link"
          },
          {
            "id": "36242433-d4b4-4053-a437-21c294a9f7c1",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Geo Location",
            "subTarget": "GeoLocation",
            "style": "link"
          },
          {
            "id": "9420cc4a-78f9-4560-8afb-c9985cc37013",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Autonomous Systems",
            "subTarget": "AutonomousSystems",
            "style": "link"
          },
          {
            "id": "7d096d4a-4364-4101-9462-690ac939482e",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Flow Exporters",
            "subTarget": "FlowExporters",
            "style": "link"
          },
          {
            "id": "3a61a97c-0d7b-48d5-aadc-433dd62a6efe",
            "cellValue": "selectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Raw Flow Records",
            "subTarget": "RawFlowRecords",
            "style": "link"
          }
        ]
      },
      "name": "Tabs"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "77bd387e-c970-4c7e-aa98-0a53a603c3ed",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "typeSettings": {
              "additionalResourceOptions": [],
              "includeAll": false,
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            }
          },
          {
            "id": "3078b6a7-5f3b-4804-98f9-7b3ce1eb110b",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "query": "where type =~ \"microsoft.operationalinsights/workspaces\"\r\n| project subscriptionId,id,name\r\n| where '{Subscription}' has subscriptionId\r\n| project value =id, label = name",
            "crossComponentResources": [
              "{Subscription}"
            ],
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              },
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 86400000
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "9c818cf9-cff5-442a-be9d-4944b5b95757",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "type": 4,
            "isRequired": true,
            "value": {
              "durationMs": 1209600000
            },
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 300000
                },
                {
                  "durationMs": 900000
                },
                {
                  "durationMs": 1800000
                },
                {
                  "durationMs": 3600000
                },
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2419200000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "timeContext": {
              "durationMs": 86400000
            }
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "Parameters"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Overview",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Transport=network_transport_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Protocol",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 36,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Protocol"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0 \r\n| summarize Bytes=sum(network_bytes_d) by DestinationIP=destination_ip_s, DestinationPort=destination_port_d\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Destiantion IP and Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "destination_ip_s",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "destination_port_d",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "graphSettings": {
                "type": 0,
                "topContent": {
                  "columnMatch": "destination_ip_s",
                  "formatter": 1
                },
                "centerContent": {
                  "columnMatch": "destination_port_d",
                  "formatter": 1,
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Destiantion IP and Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by SourceIP=source_ip_s, SourcePort=source_port_d\r\n| sort by Bytes desc\r\n",
              "size": 3,
              "title": "Total Bytes by Source IP and Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Source IP and Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by TCPFlags=tostring(toint(netflow_tcp_control_bits_d))\r\n| sort by Bytes desc\r\n",
              "size": 3,
              "title": "Total Bytes by TCP Flag",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by TCP Flag"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by TypeofService=tostring(toint(netflow_ip_class_of_service_d))\r\n| sort by Bytes desc\r\n| take 10",
              "size": 3,
              "title": "Total Bytes by Type of Service",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Type of Service"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0 and  isnotempty(netflow_vlan_id_d)\r\n| summarize Bytes=sum(network_bytes_d) by VLAN=tostring(toint(netflow_vlan_id_d))\r\n| sort by Bytes desc\r\n| take 10",
              "size": 3,
              "title": "Total Bytes by VLANs",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              },
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by VLANs"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Locality=flow_locality_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Locality",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Locality"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend AutonomousSystem = iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\r\n| summarize Bytes=sum(network_bytes_d) by AutonomousSystem\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Autonomous System",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Autonomous System"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend Country = iff(isempty(netflow_destinationGeo_country_name_s), \"Unknown\", netflow_destinationGeo_country_name_s)\r\n| summarize Bytes=sum(network_bytes_d) by Country\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Country",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Country"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Source=agent_name_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Flow Exporter",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Flow Exporter"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Direction=network_direction_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Direction",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Direction"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Version=tostring(toint(netflow_exporter_version_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by NetFlow Version",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by NetFlow Version"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "Overview"
      },
      "name": "OverviewGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Conversation Partners",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by DestinationIP=netflow_destination_ipv4_address_s, SourceIP=netflow_source_ipv4_address_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Destination and Source IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Destination and Source IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by tostring(DestinationPort=toint(netflow_destination_transport_port_d)), tostring(SourcePort=toint(netflow_source_transport_port_d))\r\n| sort by Bytes desc\r\n",
              "size": 3,
              "title": "Total Bytes by Destination and Source Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Destination and Source Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Protocol=network_transport_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Protocol",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "33",
            "name": "Total Bytes by Protocol"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| make-series Trend= sum(network_bytes_d) default = 0 on _timestamp_t from {TimeRange:start} to {TimeRange:end} step 1h by SourceIP=source_ip_s, DestinationIP=destination_ip_s\r\n| project-away _timestamp_t\r\n| join kind= inner (netflow_CL\r\n    | summarize Bytes=sum(network_bytes_d), Packets=sum(network_packets_d), FlowRecords=count() by SourceIP=source_ip_s, DestinationIP=destination_ip_s\r\n) on SourceIP, DestinationIP\r\n| project SourceIP, DestinationIP, Bytes, Packets, FlowRecords, Trend\r\n| sort by Bytes desc",
              "size": 0,
              "title": "Conversation Partners",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 4,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Packets",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "FlowRecords",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 9,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              }
            },
            "name": "Conversation Partners"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "ConversationPartners"
      },
      "name": "ConversationPartnersGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Traffic Analysis",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by SourceIP=source_ip_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Source IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Source IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct source_ip_s\r\n| summarize Sources = count() ",
              "size": 3,
              "title": "Total Unique Source IPs",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Source IPs"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by DestinationIP=destination_ip_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Destination IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Destination IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct destination_ip_s\r\n| summarize Destinations = count() ",
              "size": 3,
              "title": "Total Unique Destination IPs",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Destination IPs"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by SourceIP=source_ip_s, bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Bytes by Source IP over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Source IP over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by DestinationIP=destination_ip_s, bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Bytes by Destinaion IP over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Destinaion IP over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by SourceIP=source_ip_s, bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Packets by Source IP over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Source IP over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by DestinationIP=destination_ip_s, bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Packets by Destination IP over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Destination IP over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by SourcePort=tostring(toint(source_port_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Source Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Source Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct source_port_d\r\n| summarize Sources = count() ",
              "size": 3,
              "title": "Total Unique Source Ports",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Source Ports"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by DestinationPort=tostring(toint(destination_port_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Destination Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Destination Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct destination_port_d\r\n| summarize Destionations = count() ",
              "size": 3,
              "title": "Total Unique Destination Ports",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Destination Ports"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Sourceport=tostring(toint(source_port_d)), bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Bytes by Source Port over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Source Port over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by DestinationPort=tostring(toint(destination_port_d)), bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Bytes by Destination Port over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Destination Port over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by SourcePort=tostring(toint(source_port_d)), bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Packets by Source Port over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Source Port over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by DestinationPort=tostring(toint(destination_port_d)), bin(TimeGenerated, 5m) ",
              "size": 0,
              "title": "Total Packets by Destination Port over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Destination Port over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by ToS=tostring(toint(netflow_ip_class_of_service_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Type of Service",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Type of Service"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct netflow_ip_class_of_service_d\r\n| summarize Sources = count() ",
              "size": 3,
              "title": "Total Unique Types of Service",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Types of Service"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| where isnotempty(netflow_vlan_id_d)\r\n| summarize Bytes=sum(network_bytes_d) by VLAN=tostring(toint(netflow_vlan_id_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by VLAN",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by VLAN"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| where isnotempty(netflow_vlan_id_d)\r\n| distinct netflow_vlan_id_d\r\n| summarize VLANs = count() ",
              "size": 3,
              "title": "Total Unique VLANs",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique VLANs"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by ToS=tostring(toint(netflow_ip_class_of_service_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by Type of Service over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Type of Service over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| where isnotempty(netflow_vlan_id_d)\r\n| summarize Bytes=sum(network_bytes_d) by VLAN=tostring(toint(netflow_vlan_id_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by VLAN over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by VLAN over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by ToS=tostring(toint(netflow_ip_class_of_service_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by Type of Service over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Type of Service over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| where isnotempty(netflow_vlan_id_d)\r\n| summarize Packets=sum(network_packets_d) by VLAN=tostring(toint(netflow_vlan_id_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by VLAN over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by VLAN over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by TCPFlagStates=tostring(toint(netflow_tcp_control_bits_d))\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by TCP Flag State",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by TCP Flag State"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct netflow_tcp_control_bits_d\r\n| summarize TCPFlagStates = count() ",
              "size": 3,
              "title": "Total Unique TCP Flag States",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique TCP Flag States"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend AutonomousSystem = iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\r\n| summarize Bytes=sum(network_bytes_d) by AutonomousSystem\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Autonomous System",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Autonomous System"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend AutonomousSystem = iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\r\n| distinct AutonomousSystem\r\n| summarize ASN = count() ",
              "size": 3,
              "title": "Total Unique Autonomous Systems",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Autonomous Systems"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by TCPFlagStates=tostring(toint(netflow_tcp_control_bits_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by TCP Flag State over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by TCP Flag State over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend AutonomousSystem = iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\r\n| summarize Bytes=sum(network_bytes_d) by AutonomousSystem, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by Autonomous System over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Autonomous System over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by TCPFlagStates=tostring(toint(netflow_tcp_control_bits_d)), bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by TCP Flag State over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by TCP Flag State over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| extend AutonomousSystem = iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\r\n| summarize Packets=sum(network_packets_d) by AutonomousSystem, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by Autonomous System over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Autonomous System over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Country=netflow_destinationGeo_country_name_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by Country",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by Country"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct netflow_destinationGeo_country_name_s\r\n| summarize Countries = count() ",
              "size": 3,
              "title": "Total Unique Countries",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Countries"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by City=netflow_destinationGeo_city_name_s\r\n| sort by Bytes desc",
              "size": 3,
              "title": "Total Bytes by City",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "30",
            "name": "Total Bytes by City"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| distinct netflow_destinationGeo_city_name_s\r\n| summarize Cities = count() ",
              "size": 3,
              "title": "Total Unique Cities",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "card",
              "tileSettings": {
                "titleContent": {},
                "leftContent": {
                  "columnMatch": "Sources"
                },
                "showBorder": false
              },
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "20",
            "name": "Total Unique Cities"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by Country=netflow_destinationGeo_country_name_s, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by Country over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Country over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Bytes=sum(network_bytes_d) by City=netflow_destinationGeo_city_name_s, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Bytes by City over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                },
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by City over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by Country=netflow_destinationGeo_country_name_s, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by Country over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Country over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\r\n| where network_bytes_d > 0\r\n| summarize Packets=sum(network_packets_d) by City=netflow_destinationGeo_city_name_s, bin(TimeGenerated, 5m)",
              "size": 0,
              "title": "Total Packets by City over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "showMetrics": false,
                "showLegend": true,
                "xSettings": {
                  "numberFormatSettings": {
                    "unit": 25,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by City over Time"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "TrafficAnalysis"
      },
      "name": "TrafficAnalysisGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Top-N",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "edb4a236-c07c-487e-b31d-07ea205d73c5",
                  "version": "KqlParameterItem/1.0",
                  "name": "NetworkDirection",
                  "label": "Network Direction",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| extend NetworkDirection = iff(isempty(network_direction_s), \"unknown\", network_direction_s)\n| distinct NetworkDirection",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "value::all"
                  ]
                },
                {
                  "id": "099fe2ff-7bf5-4ce1-972e-db5016a1a77a",
                  "version": "KqlParameterItem/1.0",
                  "name": "Locality",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| extend Locality = iff(isempty(flow_locality_s), \"unknown\", flow_locality_s)\n| distinct Locality",
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "value": [
                    "value::all"
                  ]
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 0"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| where network_bytes_d > 0\n| summarize Bytes=sum(network_bytes_d) by bin(TimeGenerated, 5s)\n| take 10000\n",
              "size": 0,
              "title": "Total Bytes over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| where network_bytes_d > 0\n| summarize Packets=sum(network_packets_d) by bin(TimeGenerated, 5s)\n| take 10000\n",
              "size": 0,
              "title": "Total Packets over Time",
              "color": "orange",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| extend Transport=iff(isempty(network_transport_s), \"unknown\", network_transport_s)\n| summarize count() by Transport\n",
              "size": 3,
              "title": "Total Count by Transport",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Total Count by Transport"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| summarize count() by tostring(toint(source_port_d))\n\n",
              "size": 3,
              "title": "Total Count by Source Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Total Count by Source Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| summarize count() by tostring(toint(destination_port_d))\n\n",
              "size": 3,
              "title": "Total Count by Destination Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Total Count by Destination Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| where network_bytes_d > 0\n| make-series Trend= sum(network_bytes_d) default = 0 on _timestamp_t from {TimeRange:start} to {TimeRange:end} step 1h by SourceIP=source_ip_s\n| project-away _timestamp_t\n| join kind= inner (netflow_CL\n    | summarize Bytes=sum(network_bytes_d), Packets=sum(network_packets_d) by SourceIP=source_ip_s\n) on SourceIP\n| project SourceIP, Bytes, Packets, Trend\n| sort by Bytes desc",
              "size": 0,
              "title": "Top Sources",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Packets",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 9,
                    "formatOptions": {
                      "palette": "purple"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Top Sources"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where \"{Locality:lable}\" == \"All\" or flow_locality_s in ({Locality})\n| where \"{NetworkDirection:lable}\" == \"ALL\" or network_direction_s in ({NetworkDirection})\n| where network_bytes_d > 0\n| make-series Trend= sum(network_bytes_d) default = 0 on _timestamp_t from {TimeRange:start} to {TimeRange:end} step 1h by DestinationIP=destination_ip_s\n| project-away _timestamp_t\n| join kind= inner (netflow_CL\n    | summarize Bytes=sum(network_bytes_d), Packets=sum(network_packets_d) by DestinationIP=destination_ip_s\n) on DestinationIP\n| project DestinationIP, Bytes, Packets, Trend\n| sort by Bytes desc",
              "size": 0,
              "title": "Top Destinations",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "blue"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Packets",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  },
                  {
                    "columnMatch": "Trend",
                    "formatter": 9,
                    "formatOptions": {
                      "palette": "purple"
                    }
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Top Destinations"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "TopN"
      },
      "name": "Top-NGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Geo Location",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "6a9bd9b7-8892-4b62-9269-fd46d7439e59",
                  "version": "KqlParameterItem/1.0",
                  "name": "Country",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where isnotempty(netflow_destinationGeo_country_name_s)\n| extend Country=netflow_destinationGeo_country_name_s\n| distinct Country",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "City",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| extend City=iff(isempty(netflow_destinationGeo_city_name_s), \"Unknown\", netflow_destinationGeo_city_name_s)\n| distinct City",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "id": "28037aa1-0893-46e2-89d4-f763dbc18549"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "SourceIP",
                  "label": "Source IP",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| extend SourceIP=source_ip_s\n| distinct SourceIP",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "id": "3fc4da1d-56e0-4f74-ae05-0b719b762bd9"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "DestinationIP",
                  "label": "Destination IP",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| extend DestinationIP=destination_ip_s\n| distinct DestinationIP",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "id": "261c8d9b-4331-4cec-8b51-4679ccf37356"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "SourcePort",
                  "label": "Source Port",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| extend SourcePort=tostring(toint(source_port_d))\n| distinct SourcePort",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "id": "fbda21b6-3a6e-45e2-8eb7-4e1b11258fee"
                },
                {
                  "version": "KqlParameterItem/1.0",
                  "name": "DestinationPort",
                  "label": "Destination Port",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| extend DestinationPort=tostring(toint(destination_port_d))\n| distinct DestinationPort",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces",
                  "id": "5da579f3-545f-46b7-abb4-5d563c00a4c6"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by Country=netflow_destinationGeo_country_name_s\n| sort by Count desc",
              "size": 3,
              "title": "Top Countries",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "exportFieldName": "Country",
              "exportParameterName": "CountryParam",
              "exportDefaultValue": "All",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "chartSettings": {
                "yAxis": [
                  "Count"
                ]
              }
            },
            "customWidth": "25",
            "name": "Top Countries"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by City=netflow_destinationGeo_city_name_s\n| sort by Count desc",
              "size": 3,
              "title": "Top Cities",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Cities"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by SouceIP=source_ip_s\n| sort by Count desc",
              "size": 3,
              "title": "Top Source IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Source IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by DestinationIP=destination_ip_s\n| sort by Count desc",
              "size": 3,
              "title": "Top Destination IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Destination IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by SourcePort=tostring(toint(source_port_d))\n| sort by Count desc",
              "size": 3,
              "title": "Top Source Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "Top Source Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| summarize Count=count() by DestinationPort=tostring(toint(destination_port_d))\n| sort by Count desc",
              "size": 3,
              "title": "Top Destination Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "Top Destination Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationGeo_country_name_s in ({Country})\n| where netflow_destinationGeo_city_name_s in ({City})\n| where source_ip_s == '{SourceIP}' or '{SourceIP}' == ''\n| where destination_ip_s == '{DestinationIP}' or '{DestinationIP}' == ''\n| where source_port_d == '{SourcePort}' or '{SourcePort}' == ''\n| where destination_port_d == '{DestinationPort}' or '{DestinationPort}' == ''\n| where isnotempty(netflow_destinationGeo_latitude_d) or isnotempty(netflow_destinationGeo_longitude_d)\n| extend Destination=strcat(iff(isempty(netflow_destinationGeo_city_name_s), \"Unknown\", netflow_destinationGeo_city_name_s), \", \", netflow_destinationGeo_country_name_s) \n| summarize Count=count() by netflow_destinationGeo_latitude_d, netflow_destinationGeo_longitude_d, Destination\n| sort by Count desc ",
              "size": 3,
              "title": "Destination Geo Heatmap",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "map",
              "mapSettings": {
                "locInfo": "LatLong",
                "latitude": "netflow_destinationGeo_latitude_d",
                "longitude": "netflow_destinationGeo_longitude_d",
                "sizeSettings": "Count",
                "sizeAggregation": "Sum",
                "labelSettings": "Destination",
                "legendMetric": "Count",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "nodeColorField": "Count",
                  "colorAggregation": "Sum",
                  "type": "heatmap",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "name": "Destination Geo Heatmap"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "GeoLocation"
      },
      "name": "GeoLocationGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Autonomous System",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "911101a0-f7cd-4bf2-be52-3fe88c7691bb",
                  "version": "KqlParameterItem/1.0",
                  "name": "DestinationAS",
                  "label": "Destination AS",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where isnotempty(netflow_destinationASN_as_org_s)\n| extend DestinationAS=netflow_destinationASN_as_org_s\n| distinct DestinationAS",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": [
                    "value::all"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "5ecfe0da-7e4a-4f22-a6a7-776ac1ab3b04",
                  "version": "KqlParameterItem/1.0",
                  "name": "SourceAS",
                  "label": "Source AS",
                  "type": 2,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where isnotempty(netflow_sourceASN_as_org_s)\n| extend SourceAS=netflow_sourceASN_as_org_s\n| distinct SourceAS",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "997b2f18-9181-4cd4-bf9e-52902ec05722",
                  "version": "KqlParameterItem/1.0",
                  "name": "SourceIPAS",
                  "label": "Source IP",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| extend SourceIP=source_ip_s\n| distinct SourceIP",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "b79c8230-3f42-407a-b086-1a587f5fb866",
                  "version": "KqlParameterItem/1.0",
                  "name": "DestinationIPAS",
                  "label": "Destination IP",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| extend DestinationIP=destination_ip_s\n| distinct DestinationIP",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "ba1e4fa7-9ea8-449a-836b-6e75bcde039f",
                  "version": "KqlParameterItem/1.0",
                  "name": "SourcePortAS",
                  "label": "Source Port",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| extend SourcePort=tostring(toint(source_port_d))\n| distinct SourcePort",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "ca8a63d7-b515-452a-bbe5-88be8a7e6b0c",
                  "version": "KqlParameterItem/1.0",
                  "name": "DestinationPortAS",
                  "label": "Destination Port",
                  "type": 2,
                  "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| extend DestinationPort=tostring(toint(destination_port_d))\n| distinct DestinationPort",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "value": null,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 0
                  },
                  "timeContextFromParameter": "TimeRange",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend DestinationAS=iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\n| summarize Count=count() by DestinationAS\n| sort by Count desc ",
              "size": 3,
              "title": "Top Destination AS",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Destination AS"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend SourceAS=iff(isempty(netflow_sourceASN_as_org_s), \"Unknown\", netflow_sourceASN_as_org_s)\n| summarize Count=count() by SourceAS\n| sort by Count desc ",
              "size": 3,
              "title": "Top Source AS",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Source AS"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| summarize Count=count() by SourceIP=source_ip_s\n| sort by Count desc ",
              "size": 3,
              "title": "Top Source IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Source IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| summarize Count=count() by DestiantionIP=destination_ip_s\n| sort by Count desc ",
              "size": 3,
              "title": "Top Destination IP",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "25",
            "name": "Top Destination IP"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| summarize Count=count() by SourcePort=tostring(toint(source_port_d))\n| sort by Count desc ",
              "size": 3,
              "title": "Top Source Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "Top Source Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| summarize Count=count() by DestinationPort=tostring(toint(destination_port_d))\n| sort by Count desc ",
              "size": 3,
              "title": "Top Destination Port",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "50",
            "name": "Top Destination Port"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend SourceAS=iff(isempty(netflow_sourceASN_as_org_s), \"Unknown\", netflow_sourceASN_as_org_s)\n| summarize Bytes=sum(network_bytes_d) by SourceAS, bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Bytes of Source AS over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart"
            },
            "customWidth": "50",
            "name": "Total Bytes of Source AS over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend DestinationAS=iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\n| summarize Bytes=sum(network_bytes_d) by DestinationAS, bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Bytes of Destination AS over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart"
            },
            "customWidth": "50",
            "name": "Total Bytes of Destination AS over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend SourceAS=iff(isempty(netflow_sourceASN_as_org_s), \"Unknown\", netflow_sourceASN_as_org_s)\n| summarize Packets=sum(network_packets_d) by SourceAS, bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Packets of Source AS over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart"
            },
            "customWidth": "50",
            "name": "Total Packet of Source AS over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where netflow_destinationASN_as_org_s in ({DestinationAS}) or 'All' == '{DestinationAS:label}'\n| where netflow_sourceASN_as_org_s in ({SourceAS}) or 'All' == '{SourceAS:label}'\n| where source_ip_s == '{SourceIPAS}' or '{SourceIPAS}' == ''\n| where destination_ip_s == '{DestinationIPAS}' or '{DestinationIPAS}' == ''\n| where source_port_d == '{SourcePortAS}' or '{SourcePortAS}' == ''\n| where destination_port_d == '{DestinationPortAS}' or '{DestinationPortAS}' == ''\n| extend DestinationAS=iff(isempty(netflow_destinationASN_as_org_s), \"Unknown\", netflow_destinationASN_as_org_s)\n| summarize Packets=sum(network_packets_d) by DestinationAS, bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Packets of Source AS over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart"
            },
            "customWidth": "50",
            "name": "Total Packet of Source AS over Time - Copy"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "AutonomousSystems"
      },
      "name": "AutonomousSystemsGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Flow Exporters",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "parameters": [
                {
                  "id": "5a8924d8-a289-4f4a-bc0d-37534ea23005",
                  "version": "KqlParameterItem/1.0",
                  "name": "FlowExporter",
                  "label": "Flow Exporter",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| extend FlowExporter=agent_name_s\n| distinct FlowExporter",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "63e04eeb-cf00-4245-8928-f17e7831fc3a",
                  "version": "KqlParameterItem/1.0",
                  "name": "IngressInterface",
                  "label": "Ingress Interface",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or 'All' == '{FlowExporter:label}'\n| where isnotempty(netflow_ingress_interface_d)\n| extend IngressInterface=tostring(toint(netflow_ingress_interface_d))\n| distinct IngressInterface",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "selectAllValue": "",
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                },
                {
                  "id": "53117caa-c6ee-4db2-a820-78d57ee6d929",
                  "version": "KqlParameterItem/1.0",
                  "name": "EgressInterface",
                  "label": "Egress Interface",
                  "type": 2,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or 'All' == '{FlowExporter:label}'\n| where isnotempty(netflow_egress_interface_d)\n| extend EgressInterface=tostring(toint(netflow_egress_interface_d))\n| distinct EgressInterface",
                  "crossComponentResources": [
                    "{Workspace}"
                  ],
                  "typeSettings": {
                    "additionalResourceOptions": [
                      "value::all"
                    ],
                    "showDefault": false
                  },
                  "timeContext": {
                    "durationMs": 1209600000
                  },
                  "timeContextFromParameter": "TimeRange",
                  "defaultValue": "value::all",
                  "queryType": 0,
                  "resourceType": "microsoft.operationalinsights/workspaces"
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 3 - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Count=count() by agent_name_s",
              "size": 3,
              "title": "Flow Exporters",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Flow Exporters"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Count=count() by tostring(toint(netflow_ingress_interface_d))",
              "size": 3,
              "title": "Ingress Interfaces",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Ingress Interfaces"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Count=count() by tostring(toint(netflow_egress_interface_d))",
              "size": 3,
              "title": "Egress Interfaces",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Egress Interfaces"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Bytes=sum(network_bytes_d) by egressInterface=tostring(toint(netflow_egress_interface_d)), bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Bytes by Egress Interface over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Egress Interface over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Bytes=sum(network_bytes_d) by IngressInterface=tostring(toint(netflow_ingress_interface_d)), bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Bytes by Ingress Interface over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Bytes"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 2,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Bytes by Ingress Interface over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Packets=sum(network_packets_d) by IngressInterface=tostring(toint(netflow_ingress_interface_d)), bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Packets by Ingress Interface over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Ingress Interface over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| where agent_name_s in ({FlowExporter}) or '{FlowExporter:label}' == 'All'\n| where netflow_ingress_interface_d in ({IngressInterface}) or '{IngressInterface:label}' == 'All'\n| where netflow_egress_interface_d in ({EgressInterface}) or '{EgressInterface:label}' == 'All'\n| summarize Packets=sum(network_packets_d) by EgressInterface=tostring(toint(netflow_egress_interface_d)), bin(TimeGenerated, 5s)\n| sort by TimeGenerated desc\n| take 10000",
              "size": 0,
              "title": "Total Packets by Egress Interface over Time",
              "timeContext": {
                "durationMs": 1209600000
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "linechart",
              "chartSettings": {
                "xAxis": "TimeGenerated",
                "yAxis": [
                  "Packets"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Total Packets by Egress Interface over Time"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "FlowExporters"
      },
      "name": "FlowExportersGroup"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Raw Flow Records",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| summarize Records=count()",
              "size": 3,
              "title": "Total Flow Records",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "card",
              "textSettings": {
                "style": "bignumber"
              }
            },
            "customWidth": "33",
            "name": "Total Flow Records"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| summarize Count=count() by Version=tostring(toint(netflow_exporter_version_d)), bin(TimeGenerated, 1m)\n| sort by TimeGenerated desc",
              "size": 0,
              "title": "Flow Records over Time",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "linechart"
            },
            "customWidth": "66",
            "name": "Flow Records over Time"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "netflow_CL\n| project TimeGenerated, SourceIP=source_ip_s, SourcePort=tostring(toint(source_port_d)), DestinationIP=destination_ip_s, DestinationPort=tostring(toint(destination_port_d)), NetworkTransport=network_transport_s, Bytes=network_bytes_d, Packets=network_packets_d\n| sort by TimeGenerated desc",
              "size": 0,
              "title": "Raw Flow Records",
              "timeContext": {
                "durationMs": 0
              },
              "timeContextFromParameter": "TimeRange",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Bytes",
                    "formatter": 0,
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal"
                      }
                    }
                  }
                ]
              }
            },
            "name": "Raw Flow Records"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "selectedTab",
        "comparison": "isEqualTo",
        "value": "RawFlowRecords"
      },
      "name": "RawFlowRecordsGroup"
    }
  ],
  "fromTemplateId": "sentinel-NetFlow",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}