id: af99b078-124b-543a-9a50-66ef87c09f6a
name: 'Dynatrace Application Security - Third-Party vulnerability detected'
description: |
  'Detect Third-Party vulnerabilities in your environment at runtime insights by snyk'
severity: High
status: Available
requiredDataConnectors:
  - connectorId: DynatraceSecurityProblems
    dataTypes:
      - DynatraceSecurityProblems_CL
queryFrequency: P1D
queryPeriod: P1D
triggerOperator: GreaterThan
triggerThreshold: 0
suppressionDuration: PT5H
suppressionEnabled: false
eventGroupingSettings:
  aggregationKind: AlertPerResult
query: |
  DynatraceSecurityProblems_CL
  | where vulnerabilityType_s != "CODE_LEVEL" and riskAssessment_riskLevel_s == "CRITICAL"
  | summarize  arg_max(lastUpdatedTimestamp_d, *) by securityProblemId_s
alertDetailsOverride:
  alertDisplayNameFormat: 'Dynatrace Third-party vulnerability  detected - {{displayId_s}} : {{title_s}}'
  alertDescriptionFormat: 'Third-party/Runtime vulnerability ({{externalVulnerabilityId_s}}) detected in package ({{packageName_s}}), more details available from Dynatrace at {{url_s}}.'
  alertSeverityColumnName: riskAssessment_riskLevel_s
customDetails:
  securityProblemId: securityProblemId_s
  displayId: displayId_s
  securityProblemUrl: url_s
  riskLevel: riskAssessment_riskLevel_s
  packageName: packageName_s
  technology: technology_s
  vulnerabilityType: vulnerabilityType_s
  cveIds: cveIds_s
  externVulnId: externalVulnerabilityId_s
  riskScore: riskAssessment_baseRiskScore_d
  riskVector: riskAssessment_baseRiskVector_s
  exposure: riskAssessment_exposure_s
  publicExploit: riskAssessment_publicExploit_s
  dataAssets: riskAssessment_dataAssets_s
  vulnerableFuncUsage: riskAssessment_vulnerableFunctionUsage_s
incidentConfiguration:
  createIncident: true
  groupingConfiguration:
    enabled: true
    reopenClosedIncident: true
    lookbackDuration: P7D
    matchingMethod: Selected
    groupByEntities:
    groupByAlertDetails: []
    groupByCustomDetails:
      - securityProblemId
version: 1.0.0
kind: Scheduled
