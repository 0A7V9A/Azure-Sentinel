id: fd7009d7-30d4-47bf-89f5-32910e08a036
Function:
  Title: Parser for IvantiUEMEvent
  Version: '1.0.0'
  LastUpdated: '2023-08-03'
Category: Microsoft Sentinel Parser
FunctionName: IvantiUEMEvent
FunctionAlias: IvantiUEMEvent
FunctionParams:
FunctionQuery: |
    Syslog
    | where SyslogMessage has_all ('Alert', 'Message')
    | extend EventVendor = 'Ivanti'
    | extend EventProduct = 'Ivanti Unified Endpoint Management'
    | extend EventCount = 1
    | extend EventSchemaVersion = 0.2
    | extend ed = split(SyslogMessage, ' ')
    | extend SrcHostname = extract(@'\A([A-Za-z0-9_-]+)\.\w+', 1, tostring(ed[0]))
    | extend SrcDomain = extract(@'\A[A-Za-z0-9_-]+\.(.*)', 1, tostring(ed[0]))
    | extend EventType = trim(' ', extract(@'Alert:\s(.*?)Message:', 1, SyslogMessage))
    | extend EventMessage = extract(@'Message:\s(.*)', 1, SyslogMessage)
    | project-away SyslogMessage
                 , ed