id: 2096c21d-bf9f-42f5-99db-201b7a26b049
Function:
  Title: Parser for OCILogs
  Version: '1.0.0'
  LastUpdated: '2023-08-08'
Category: Microsoft Sentinel Parser
FunctionName: OCILogs
FunctionAlias: OCILogs
FunctionQuery: |
    OCI_Logs_CL
    | extend EventVendor = 'Oracle'
    | extend EventProduct = 'Oracle Cloud Infrastructure'
    | extend EventStartTime = iff(isnull(data_startTime_d), time_t, unixtime_seconds_todatetime(data_startTime_d))
    | extend EventEndTime = iff(isnull(data_endTime_d), time_t, unixtime_seconds_todatetime(data_endTime_d))
    | project-rename EventType=type_s
    | extend SrcIpAddr=iff(isnotempty(data_sourceAddress_s), data_sourceAddress_s, data_identity_ipAddress_s)
    | project-rename SrcPortNumber=data_sourcePort_d
    | project-rename DstIpAddr=data_destinationAddress_s
    | project-rename DstPortNumber=data_destinationPort_d
    | project-rename DstBytes=data_bytesOut_d
    | project-rename NetworkProtocol=data_protocolName_s
    | project-rename EventMessage=data_message_s
    | project-rename HttpUserAgentOriginal=data_identity_userAgent_s
    | project-rename HttpStatusCode=data_response_status_s
    | project-rename HttpRequestMethod=data_request_action_s