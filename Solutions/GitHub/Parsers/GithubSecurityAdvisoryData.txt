// GitHub Enterprise repository vulnerability Data Parser
// Last Updated Date: June 15, 2022
//
//This parser parses GitHub Enterprise security advisory events and extract the information from their various components. It is assumed that you are using officially supported Github webhook connector (installed from Content hub)
//
// Parser Notes:
// 1. This parser pulls the logs those are collected into a custom log table entitled githubscanaudit_CL 


githubscanaudit_CL
|where security_advisory_s <> ''
|where action_s in ('published', 'updated' ,'performed', 'withdrawn')
|extend EventType='dependabotAlert-SecurityAdvisory'
|extend sa = todynamic(
replace_string(replace_string(replace_string(replace_string(security_advisory_s,"'","\""), "None","\"None\""),"False","\"False\""),"True","\"True\"")) 
|extend  description = sa.description,
         ghsa_id = sa.ghsa_id,
         identifiervalue =  sa.identifiers,
         publishedat = sa.published_at,
         severity = sa.severity,
         vulnerabilities = sa.vulnerabilities,
         //identifiervaules = parse_json(sa.identifiers)
|project TimeGenerated,EventType,description,ghsa_id, identifiervalue, publishedat,severity,vulnerabilities



