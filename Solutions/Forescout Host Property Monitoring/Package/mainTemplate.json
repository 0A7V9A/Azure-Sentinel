{
    "$schema":  "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion":  "1.0.0.0",
    "metadata":  {
                     "author":  "Julian Wang - julian.wang@forescout.com",
                     "comments":  "Solution template for Forescout Host Property Monitor"
                 },
    "parameters":  {
                       "location":  {
                                        "type":  "string",
                                        "minLength":  1,
                                        "defaultValue":  "[resourceGroup().location]",
                                        "metadata":  {
                                                         "description":  "Not used, but needed to pass arm-ttk test `Location-Should-Not-Be-Hardcoded`.  We instead use the `workspace-location` which is derived from the LA workspace"
                                                     }
                                    },
                       "workspace-location":  {
                                                  "type":  "string",
                                                  "defaultValue":  "",
                                                  "metadata":  {
                                                                   "description":  "[concat(\u0027Region to deploy solution resources -- separate from location selection\u0027,parameters(\u0027location\u0027))]"
                                                               }
                                              },
                       "workspace":  {
                                         "defaultValue":  "",
                                         "type":  "string",
                                         "metadata":  {
                                                          "description":  "Workspace name for Log Analytics where Microsoft Sentinel is setup"
                                                      }
                                     },
                       "playbook1-PlaybookName":  {
                                                      "defaultValue":  "DnsniffEventPlaybook-1",
                                                      "type":  "string",
                                                      "minLength":  1,
                                                      "metadata":  {
                                                                       "description":  "Resource name for the logic app playbook.  No spaces are allowed"
                                                                   }
                                                  }
                   },
    "variables":  {
                      "playbook1-Playbooks":  "playbook1-Playbooks",
                      "_playbook1-Playbooks":  "[variables(\u0027playbook1-Playbooks\u0027)]",
                      "playbook1-MicrosoftSentinelConnectionName":  null,
                      "playbook-1-connection-2":  "[concat(\u0027/subscriptions/\u0027, subscription().subscriptionId, \u0027/providers/Microsoft.Web/locations/\u0027, parameters(\u0027workspace-location\u0027), \u0027/managedApis/Azuresentinel\u0027)]",
                      "_playbook-1-connection-2":  "[variables(\u0027playbook-1-connection-2\u0027)]",
                      "sourceId":  "azuresentinel.azure-sentinel-solution-forescout",
                      "_sourceId":  "[variables(\u0027sourceId\u0027)]"
                  },
    "resources":  [
                      {
                          "properties":  {
                                             "definition":  {
                                                                "actions":  {
                                                                                "For_each":  {
                                                                                                 "actions":  {
                                                                                                                 "Condition":  {
                                                                                                                                   "actions":  {
                                                                                                                                                   "Set_variable_6":  {
                                                                                                                                                                          "runAfter":  {
                                                                                                                                                                                           "Set_variable_4":  [
                                                                                                                                                                                                                  null
                                                                                                                                                                                                              ]
                                                                                                                                                                                       }
                                                                                                                                                                      }
                                                                                                                                               },
                                                                                                                                   "runAfter":  {
                                                                                                                                                    "For_each_5":  [
                                                                                                                                                                       null
                                                                                                                                                                   ]
                                                                                                                                                },
                                                                                                                                   "else":  {
                                                                                                                                                "actions":  {
                                                                                                                                                                "Set_variable_7":  {
                                                                                                                                                                                       "runAfter":  {
                                                                                                                                                                                                        "Set_variable_5":  [
                                                                                                                                                                                                                               null
                                                                                                                                                                                                                           ]
                                                                                                                                                                                                    }
                                                                                                                                                                                   }
                                                                                                                                                            }
                                                                                                                                            },
                                                                                                                                   "expression":  {
                                                                                                                                                      "and":  [
                                                                                                                                                                  {
                                                                                                                                                                      "greaterOrEquals":  [
                                                                                                                                                                                              {

                                                                                                                                                                                              },
                                                                                                                                                                                              5
                                                                                                                                                                                          ]
                                                                                                                                                                  }
                                                                                                                                                              ]
                                                                                                                                                  }
                                                                                                                               },
                                                                                                                 "For_each_5":  {
                                                                                                                                    "runAfter":  {
                                                                                                                                                     "Set_variable_2":  [
                                                                                                                                                                            null
                                                                                                                                                                        ]
                                                                                                                                                 }
                                                                                                                                },
                                                                                                                 "Set_variable_2":  {
                                                                                                                                        "runAfter":  {
                                                                                                                                                         "Set_variable_8":  [
                                                                                                                                                                                null
                                                                                                                                                                            ]
                                                                                                                                                     }
                                                                                                                                    },
                                                                                                                 "Set_variable_3":  {
                                                                                                                                        "runAfter":  {
                                                                                                                                                         "Parse_JSON":  [
                                                                                                                                                                            null
                                                                                                                                                                        ]
                                                                                                                                                     }
                                                                                                                                    },
                                                                                                                 "Set_variable_8":  {
                                                                                                                                        "runAfter":  {
                                                                                                                                                         "Set_variable_3":  [
                                                                                                                                                                                null
                                                                                                                                                                            ]
                                                                                                                                                     }
                                                                                                                                    },
                                                                                                                 "Update_incident":  {
                                                                                                                                         "runAfter":  {
                                                                                                                                                          "Condition":  [
                                                                                                                                                                            null
                                                                                                                                                                        ]
                                                                                                                                                      }
                                                                                                                                     }
                                                                                                             },
                                                                                                 "runAfter":  {
                                                                                                                  "Initialize_variable_6":  [
                                                                                                                                                null
                                                                                                                                            ]
                                                                                                              },
                                                                                                 "runtimeConfiguration":  {
                                                                                                                              "concurrency":  {
                                                                                                                                                  "repetitions":  1
                                                                                                                                              }
                                                                                                                          }
                                                                                             },
                                                                                "Initialize_variable":  {
                                                                                                            "inputs":  {
                                                                                                                           "variables":  [
                                                                                                                                             {

                                                                                                                                             }
                                                                                                                                         ]
                                                                                                                       }
                                                                                                        },
                                                                                "Initialize_variable_2":  {
                                                                                                              "runAfter":  {
                                                                                                                               "Initialize_variable":  [
                                                                                                                                                           null
                                                                                                                                                       ]
                                                                                                                           },
                                                                                                              "inputs":  {
                                                                                                                             "variables":  [
                                                                                                                                               {

                                                                                                                                               }
                                                                                                                                           ]
                                                                                                                         }
                                                                                                          },
                                                                                "Initialize_variable_3":  {
                                                                                                              "runAfter":  {
                                                                                                                               "Initialize_variable_2":  [
                                                                                                                                                             null
                                                                                                                                                         ]
                                                                                                                           },
                                                                                                              "inputs":  {
                                                                                                                             "variables":  [
                                                                                                                                               {

                                                                                                                                               }
                                                                                                                                           ]
                                                                                                                         }
                                                                                                          },
                                                                                "Initialize_variable_4":  {
                                                                                                              "runAfter":  {
                                                                                                                               "Initialize_variable_3":  [
                                                                                                                                                             null
                                                                                                                                                         ]
                                                                                                                           },
                                                                                                              "inputs":  {
                                                                                                                             "variables":  [
                                                                                                                                               {

                                                                                                                                               }
                                                                                                                                           ]
                                                                                                                         }
                                                                                                          },
                                                                                "Initialize_variable_5":  {
                                                                                                              "runAfter":  {
                                                                                                                               "Initialize_variable_4":  [
                                                                                                                                                             null
                                                                                                                                                         ]
                                                                                                                           },
                                                                                                              "inputs":  {
                                                                                                                             "variables":  [
                                                                                                                                               {

                                                                                                                                               }
                                                                                                                                           ]
                                                                                                                         }
                                                                                                          },
                                                                                "Initialize_variable_6":  {
                                                                                                              "runAfter":  {
                                                                                                                               "Initialize_variable_5":  [
                                                                                                                                                             null
                                                                                                                                                         ]
                                                                                                                           },
                                                                                                              "inputs":  {
                                                                                                                             "variables":  [
                                                                                                                                               {
                                                                                                                                                   "value":  0
                                                                                                                                               }
                                                                                                                                           ]
                                                                                                                         }
                                                                                                          }
                                                                            }
                                                            }
                                         },
                          "dependsOn":  [
                                            null
                                        ]
                      },
                      {

                      },
                      {
                          "type":  "Microsoft.OperationalInsights/workspaces/providers/metadata",
                          "apiVersion":  "2021-03-01-preview",
                          "properties":  {
                                             "version":  "1.0.0",
                                             "kind":  "Solution",
                                             "contentId":  "[variables(\u0027_sourceId\u0027)]",
                                             "parentId":  "[variables(\u0027_sourceId\u0027)]",
                                             "source":  {
                                                            "kind":  "Solution",
                                                            "name":  "Forescout Host Property Monitor",
                                                            "sourceId":  "[variables(\u0027_sourceId\u0027)]"
                                                        },
                                             "author":  {
                                                            "name":  "Julian",
                                                            "email":  "Wang"
                                                        },
                                             "support":  {
                                                             "name":  "Microsoft Corporation",
                                                             "email":  "support@microsoft.com",
                                                             "tier":  "Microsoft",
                                                             "link":  "https://support.microsoft.com"
                                                         },
                                             "dependencies":  {
                                                                  "operator":  "AND",
                                                                  "criteria":  [
                                                                                   {
                                                                                       "kind":  "Playbook",
                                                                                       "contentId":  "[variables(\u0027_playbook1-Playbooks\u0027)]",
                                                                                       "version":  "1.0.0"
                                                                                   }
                                                                               ]
                                                              },
                                             "firstPublishDate":  "2022-07-28",
                                             "providers":  [
                                                               "Forescout"
                                                           ],
                                             "categories":  {
                                                                "domains":  [
                                                                                "Security â€“ Network"
                                                                            ]
                                                            }
                                         },
                          "name":  "[concat(parameters(\u0027workspace\u0027),\u0027/Microsoft.SecurityInsights/\u0027, variables(\u0027_sourceId\u0027))]"
                      }
                  ],
    "outputs":  {

                }
}
