id: c3739dbb-10d3-4f1c-af32-9530c363d261
Function:
  Title: Parser for BitSightCompanyRatings
  Version: '1.0.0'
  LastUpdated: '2023-08-03'
Category: Microsoft Sentinel Parser
FunctionName: BitSightCompanyRatings
FunctionAlias: BitSightCompanyRatings
FunctionParams:
FunctionQuery: |
    let CompanyRatings_view  = view () {
        Company_rating_details_CL
        | extend
                    EventVendor ="BitSight",
                    EventProduct ="CompanyRating",
                    CompanyName = column_ifexists('Company_name_s', ''),
                    Beta = column_ifexists('beta_b', ''),
                    Category = column_ifexists('Category', ''),
                    CategoryOrder = column_ifexists('category_order_d', ''),
                    DisplayURL = column_ifexists('display_url_s', ''),
                    Grade = column_ifexists('grade_s', ''),
                    GradeColor = column_ifexists('grade_color_s', ''),
                    Name = column_ifexists('name_s', ''),
                    Order = column_ifexists('order_d', ''),
                    Percentile = column_ifexists('percentile_d', ''),
                    Rating = column_ifexists('rating_d', '')
        | project
                    TimeGenerated,
                    EventVendor,
                    EventProduct,
                    CompanyName,
                    Beta,
                    Category,
                    CategoryOrder,
                    DisplayURL,
                    Grade,
                    GradeColor,
                    Name,
                    Order,
                    Percentile,
                    Rating,
                    Type
    };
    CompanyRatings_view