id: d68b758a-b117-4cb8-8e1d-dcab5a4a2f21
name: Alert whenever there is a compromised systems finding in BitSight
description: |
  'Creates an incident whenever there is a compromised systems finding in BitSight.'
severity: High
query: |
    let timeframe = 24h;
    FindingsData_view
    | where ingestion_time() > ago(timeframe)
    | where RiskCategory == "Compromised Systems"
    | project FirstSeen, CompanyName, Severity, RiskCategory, RiskVector, TemporaryId
queryFrequency: 1d
queryPeriod: 14d
triggerOperator: GreaterThan
triggerThreshold: 0
incidentConfiguration:
    createIncident: true
    groupingConfiguration:
      enabled: false
      reopenClosedIncident: false
      lookbackDuration: 5h
      matchingMethod: AllEntities
      groupByEntities: []
      groupByAlertDetails: []
      groupByCustomDetails: []
eventGroupingSettings:
    aggregationKind: AlertPerResult
alertDetailsOverride:
    alertDisplayNameFormat: 'BitSight: Alert for {{RiskCategory}} in {{CompanyName}} from BitSight'
    alertDescriptionFormat: |-
      Alert is generated for {{CompanyName}}.

      TemporaryId: {{TemporaryId}}
      Risk Vector: {{RiskVector}}
    alertSeverityColumnName: Severity
    alertDynamicProperties: [] 
version: 1.0.1
kind: Scheduled
