id: f65bfcdd-4da8-41fd-bca1-de6599400cd7
name: Alerts when there are new Bad Open Ports discovered
description: |
  'Creates an incident when there are new Bad Open Ports discovered.'
severity: High
status: Available
requiredDataConnectors:
  - connectorId: BitSight
    dataTypes:
      - BitSightFindingsData
queryFrequency: 1d
queryPeriod: 14d
triggerOperator: GreaterThan
triggerThreshold: 0
query: |
    let timeframe = 24h;
    BitSightFindingsData
    | where ingestion_time() > ago(timeframe)
    | where RiskVector == "open_ports"
    | project FirstSeen, CompanyName, Severity, RiskVector, TemporaryId, RiskCategory
incidentConfiguration:
    createIncident: true
    groupingConfiguration:
      enabled: false
      reopenClosedIncident: false
      lookbackDuration: 5h
      matchingMethod: AllEntities
eventGroupingSettings:
    aggregationKind: AlertPerResult
alertDetailsOverride:
    alertDisplayNameFormat: 'BitSight: Alert for {{RiskVector}} in {{CompanyName}} from BitSight'
    alertDescriptionFormat: 'Alert is generated for {{CompanyName}}.\n\nTemporaryId: {{TemporaryId}}\nRisk Category: {{RiskCategory}}'
    alertSeverityColumnName: Severity
version: 1.0.1
kind: Scheduled
