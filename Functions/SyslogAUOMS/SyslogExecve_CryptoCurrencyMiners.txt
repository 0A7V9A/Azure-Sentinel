// Use the SyslogExecve function from SyslogExecve.txt to hunt for crypto currency miners being downloaded
//

SyslogExecve
| where comm in ("wget", "curl")
| where cmdline contains "nicehashminer" or cmdline contains "ethminer" or cmdline contains "equihash" or cmdline contains "NsCpuCNMiner64" or cmdline contains "minergate" or cmdline contains "minerd" or cmdline contains "cpuminer" or cmdline contains "xmr-stak-cpu" or cmdline contains "xmrig" or cmdline contains "stratum+tcp" or cmdline contains "cryptonight" or cmdline contains "monero" or cmdline contains "oceanhole" or cmdline contains "dockerminer" or cmdline contains "xmrdemo"
| project TimeGenerated, Computer, audit_user, user, cmdline
| sort by TimeGenerated desc

