id: 3ff0fffb-d963-40c0-b235-3404f915add7
name: GitHub Two Factor Auth Disable
description: |
  'This alerts when someone disables Two Factor Auth in GitHub.'
severity: Medium
requiredDataConnectors:
  - connectorId: CustomConnector
    dataTypes:
      - GitHub_CL
queryFrequency: 1d
queryPeriod: 1d
triggerOperator: gt
triggerThreshold: 0
tactics:
  - DefenseEvasion
relevantTechniques:
  - T1089
query: |

  let timeframe = 14d;
  GitHubAudit
  | where TimeGenerated > ago(timeframe)
  | where Action == "org.disable_two_factor_requirement"
  | project TimeGenerated, Action, Actor, Country, IPaddress, Repository
  | extend AccountCustomEntity = Actor, IPCustomEntity = IPaddress