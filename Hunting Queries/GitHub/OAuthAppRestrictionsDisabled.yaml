id: 667e6a70-adc9-49b7-9cf3-f21927c71959
name: GitHub OAuth App Restrictions Disabled
description: |
  'This hunting query identifies GitHub OAuth Apps that have restrictions disabled that may be a sign of compromise.'
requiredDataConnectors:
  - connectorId: CustomConnector
    dataTypes:
      - GitHub_CL
tactics:
  - Persistence
relevantTechniques:
  - T1100
query: |

  let timeframe = 14d;
  GitHub_CL
  | extend TimeGenerated = node_createdAt_t
  | where TimeGenerated > ago(timeframe)
  | where node_action_s == "org.disable_oauth_app_restrictions"
  | project ["Action"]=node_action_s , ["TimeGenerated"]=TimeGenerated ,["User"]=node_actorLogin_s ,["Location"]=node_actorLocation_country_s
