id: ec986fb7-34ed-4528-a5f3-a496e61d8860
name: GitHub Update Permissions
description: |
  'This hunting query identifies GitHub activites where permissions are updated that may be a sign of compromise.'
requiredDataConnectors:
  - connectorId: CustomConnector
    dataTypes:
      - GitHub_CL
tactics:
  - Persistence
relevantTechniques:
  - T1098
query: |

  GitHub_CL
  | where action_s == "org.update_default_repository_permission"
  | project ["Action"]=action_s , ["TimeGenerated"]=createdAt_t ,["User"]=actorLogin_s ,["Location"]=actorLocation_country_s, ["Repo Name"]=repositoryName_s, ["Previous Permission"]=permissionWas_s,["New Permission"]=permission_s
