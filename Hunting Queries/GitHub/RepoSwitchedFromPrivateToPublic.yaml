id: a6e2afd3-559c-4e88-a693-39c1f6789ef1
name: GitHub Repo switched from private to public
description: |
  'This hunting query identifies GitHub activites where a repo was changed from private to public that may be a sign of compromise.'
requiredDataConnectors:
  - connectorId: CustomConnector
    dataTypes:
      - GitHub_CL
tactics:
  - Collection
relevantTechniques:
  - T1213
query: |

  let timeframe = 14d;
  GitHub_CL
  | where TimeGenerated > ago(timeframe)
  | where action_s == "repo.access"
  | where operationType_s == "MODIFY"
  | where visibilit_s == "PUBLIC" 
  | project ["Action"]=action_s , ["TimeGenerated"]=createdAt_t ,["User"]=actorLogin_s ,["Location"]=actorLocation_country_s, ["Repo Name"]=repositoryName_s, ["Permission"]=visibility_s
