id: a6e2afd3-559c-4e88-a693-39c1f6789ef1
name: GitHub Repo switched from private to public
description: |
  'This hunting query identifies GitHub activites where a repo was changed from private to public that may be a sign of compromise.'
requiredDataConnectors:
  - connectorId: CustomConnector
    dataTypes:
      - GitHub_CL
tactics:
  - Collection
relevantTechniques:
  - T1213
query: |

  let timeframe = 14d;
  GitHub_CL
  | extend TimeGenerated = node_createdAt_t
  | where TimeGenerated > ago(timeframe)
  | where node_action_s == "repo.access"
  | where node_operationType_s == "MODIFY"
  | where node_visibility_s == "PUBLIC" 
  | project ["Action"]=node_action_s , ["TimeGenerated"]=TimeGenerated, ["User"]=node_actorLogin_s ,["Location"]=node_actorLocation_country_s, ["Repo Name"]=node_repositoryName_s, ["Permission"]=node_visibility_s
