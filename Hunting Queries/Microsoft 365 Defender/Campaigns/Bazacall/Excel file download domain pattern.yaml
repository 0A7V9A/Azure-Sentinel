id: d66e1938-7926-4aab-b3cb-cd394ddad0b1
name: Excel file download domain pattern
description: |-
  BazaCall is a campaign that manipulate users into calling a customer support center, where they are instructed to download an Excel file to unsubscribe from a phony service. When the user opens the Excel file, they are prompted to enable a malicious macro that infects their device with BazaLoader.
  This query surfaces connections to the distinctive .xyz domains that the BazaCall campaign uses to host malicious Excel files.
requiredDataConnectors:
- connectorId: Microsoft365Defender
  dataTypes:
  - DeviceNetworkEvents
tactics:
- Initial access
query: |-
  DeviceNetworkEvents
  | where RemoteUrl matches regex @".{14}\.xyz/config\.php"
