id: 0b138f8c-457c-430d-98d4-1adba3659d3b
name: StrRAT-AV-Discovery
description: |-
  StrRAT is a Java-based remote access tool which steals browser credentials, logs keystrokes and take remote control of infected systems. It also has a module to download additional payload onto to the infected machine based on C2 server command. Additionally, this threat also has a ransomware encryption/decryption module which appends .crimson extension.
requiredDataConnectors:
- connectorId: Microsoft365Defender
  dataTypes:
  - DeviceProcessEvents
tactics:
- Defense evasion
query: |-
  DeviceProcessEvents
  | where InitiatingProcessFileName in~("java.exe", "javaw.exe") and InitiatingProcessCommandLine has "roaming"
  | where FileName == 'cmd.exe' and  ProcessCommandLine has 'path antivirusproduct get displayname'
