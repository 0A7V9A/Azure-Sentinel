id: 4ceb6a44-4452-490f-bccf-fa4317b5a410
name: ExploitGuardNetworkProtectionEvents (0)
description: |-
  Simple query to show the unique network connections that were audited or blocked by ExploitGuard.
  For more questions on this query, feel free to ping @FlyingBlueMonki on twitter or mattegen@microsoft.com via email.
requiredDataConnectors:
- connectorId: Microsoft365Defender
  dataTypes:
  - DeviceEvents
query: |-
  DeviceEvents
  | where Timestamp > ago(7d)
  | where  ActionType  =~ "ExploitGuardNetworkProtectionBlocked"
  | summarize count(RemoteUrl) by InitiatingProcessFileName, RemoteUrl, Audit_Only=tostring(parse_json(AdditionalFields).IsAudit)
  | sort by count_RemoteUrl desc
