id: d26f8f7b-87b5-46ab-9822-79c17a3ea9ab
name: Suspicious Image Load related to IcedId
description: |-
  Use this query to locate suspicious load image events by rundll32.exe or regsvr32.exe, a behavior associated with IcedId, which can lead to ransomware.
requiredDataConnectors:
- connectorId: Microsoft365Defender
  dataTypes:
  - DeviceImageLoadEvents
tactics:
- Execution
- Ransomware
query: |-
  DeviceImageLoadEvents 
  | where InitiatingProcessFileName in~ ('rundll32.exe','regsvr32.exe') 
  | where FileName endswith '.txt' or FileName endswith '.pdf'
