{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "Custom Connector Name": {
      "defaultValue": "ZeroNetworksConnector",
      "type": "string",
      "metadata": {
        "description": "Name of the Connector"
      }
    },
    "Service Endpoint": {
      "defaultValue": "https://portal.zeronetworks.com/api/v1",
      "type": "string",
      "metadata": {
        "description": "URL of the Rest API"
      }
    }
  },
  "variables": {
    "urlHost": "[split(parameters('Service Endpoint'), '/')[0]]",
    "apiPath": "[split(parameters('Service Endpoint'), '.com')[1]]"
  },
  "resources": [
    {
      "type": "Microsoft.Web/customApis",
      "apiVersion": "2016-06-01",
      "name": "[parameters('Custom Connector Name')]",
      "location": "[resourceGroup().location]",
      "properties": {
        "connectionParameters": {
          "api_key": {
            "type": "securestring",
            "uiDefinition": {
              "displayName": "API Key",
              "description": "The API Key for this api",
              "tooltip": "Provide your API Key",
              "constraints": {
                "tabIndex": 2,
                "clearText": false,
                "required": "true"
              }
            }
          }
        },
        "backendService": {
          "serviceUrl": "[parameters('Service Endpoint')]"
        },
        "brandColor": "#ffffff",
        "displayName": "[parameters('Custom Connector Name')]",
        "description": "Zero Networks Rest API",
        "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUgAAADnCAYAAAB8Kc+8AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAITYAACE2AeEffZ4AABaASURBVHhe7d0JlCxVfcfxB0kIBIlAXAgGECMKohKMGISwCFERCbIIMWyRRYGgoIBiQBBXUEENqKh4ICgSlQguRMETDEsQJCKLImKCQogoCfFJFHmImvy+VXWHnnmzdFfXzPSb+X7O+Z9auqa6uqf731X33rp3iSRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiQtSis100Vts6UXb5nJy+qlaf0icerNa+3+43pxyZJVV93ldzM5ntlqxez7zrJll3yoma/kGJ6ayeH10ki4Ocd4bjNfyTE+M5OD6qVZ9cvEzxL3Ju5IfDPxoxzP/2U67/I+/HYmGyY2SayX+L3E6olfJzju/07cmbgtcXeO+1eZap6YICMJ8pBMzq6XpvRwYr8kx0/Xi2PJ8ZLENtWKuXFZvjQ7NfOVHMcLMrmsXhoJn8kxvrSZr+QY98jkM/XSnCJh3p74QuLjOa5vs3Iu5bWvk8meiRcl+DFeOzHTd4+E+cPEVQk+Y1/Isf80U82hlZuppseX7OAJyZFf/YsTc5kcNbjfTGyaeEPiW/m/fTHxHB6YTXmOlRPbJz6bxbsT70+8OMEZYz8nJnw3n5D4y8QnEvdkX2cneC2aIybImfFLfmiS48frxerDv1omJMcdqhVaUZCYOIu7Jv/DsxL8yHUu+90ik8sTX0m8JEGSHtajElzp3Jj9fyKxQbVWs8oEOT2S4xFJjufUi2PJkTPJ51crtCIiYR2WuC7/zydXazqQfa2R4Ezx2sT2idkowvqtxD6JW/NcxyS6SL6agglyaiTHY5McxypE8mFcJZMLErtUK7Sie3riyvxfqTAZSvZBJdT1iSMSv8G6WcbZ72mJL+W5H1+tUedMkJOjxvO4JMf31otjyfH8xG7VCi0U6yYuy/+XGuVW8rd/nsnViY2rFXPrzxKcCZPs1TET5PJIjicnOfLrXMmHj8uYjyb2qlZooSE5XpD/M5evA8nfcLn7DwlaNMyXJyauyLE8u15UV0yQ45Ec3554a7UU+dBxufSRxP7VCi1Uf5p4bT3bn3w2qIChfJqri/lG7TiX29Zyd8gEOd47Eyfl7LFqVJwPG+8Phe4HsqwF74T8z/sqz8t2m2dCkQsNv0fFYxKfz7E9rl7UsEyQjzgzcUJPcqQG8vQEtZ1aHLhMfk09O7V8NtbM5FMJmt6Mmiclzs0xzkVF0YJngqx9MfGaJEdqrktypAxyxi/LAvC8xDM6joEuVUfMgfn/05RrOvxwblTPjqSdE/6wd2A22mmt8PIFeUsmJ9ZLI6frWw3Xzf64pW1W5Rjn61bDNnbOe/KlZn6cvI7tMqEB+KifXNyf2GQu/rcLmQlygnwBeE+6unSiAwuSQle3I3I/+N750HP72pgFniDprIHmVg9WSzPj0pJaaRpqt226c0bek6Oa+TF5DeybRuDcKbMi+Ehex6HNvFowQc6SfJlIjpRT7VqtGB7J8aB84KkYGGeBJ0he9zo5xrEelPqR56Py5OgErRIG/Zxfl+d7bjM/JvukvePn66VO8Nrocei/EpyRcu81txB2dXa6LPG0vJbv14salGWQsyBfJJp9cO92V8mRs6hXTJYcNbm8Vw8lTsnsuK7h+kT3cePkf0qS7aJslUrAKxJ7Jx6bIIFtl+Aq4w8TJEm6rqObtmHxI82dPWrJBNmxfJFoVP6xxLjuvoZAcjw8X6Dz6kUN6APNdBDcUz2x4fdTEtvWs63dk6Dt5A75f16YuD9RtZoA8wn6riSp/3HiyMQDPDaE/fNaRqkp0grFBNmhJjnSqPwvqhXDo1b9mHxhZuqrUlPj8nLQJMPZ4sTG3/zgDdN0hn4ot8z/kn4dx5LiVLLNwwmantFjFJ3otkWbSHudaskE2ZEkR97LsxJdNSrnS/S6fEn+tl5USyS6Lu50GaaDkv9MvCD/S/qFHEj+hg4wOOukPLEtO1dpyUqaDjTJ8YxEV+U9JMc3Jk7JF2TGs408/zCVNJR3/aSe7QxDBVzTzFdyjHNaSVPkeWkT+I/1Ut94zjXynA+xkH2skcl9iTaJlquAF2VfX64X28kx0OEvZapt3JrntzOLFkyQQ8oHl/fw3YljqhXdeHM+0Cc38zPKMSzkIRdaJ8g8J821rkw8q1rRPxL8+s08++E+bXrraYOhHl6S/c34QzedHAMVLlymM57NoEj0vIdd/xAueF5iD+8diS6TI/t7cz2rNpJMVknQczi1xYMmR0ysQR6mv8gPDpsckX1wiU2PUm1QSUMNuQZkgmwpX8CVEiSy4+o1nXhP4sQuvlALCBVfN+S9vqPPuCvbM7gVt49SE9zGxLNFuhNrg+P453q2E59rpm04REMLJsj2SIzcjthVMQXNUaiUqe4H1xjeXxIUnTD0E1waD1Mpw4/TxDJLeslpg7K/qhyzI99J/LyeHRjdoWlAJsgWcpby+ky4FO4qOX44cZTJcSTckLi1nh3Tth3hD5ppV/h8cNdNG6PY89DIM0EOKMmRmmpqE7tKjtxxc0SSowPEj4b3dfhD1dVnpNds7FNTMEEOIMmRG/9pztPV+8Z4x9xfbXIcDTcnxsY+79G2DSK3DXaJhuptB+iiPFQDMkH2KcnxoEzoXbyr94xxTA5Ocvxlvah5xv/h1fl/0KxooraXtZvmczNT35KDoC0jzX3a+J9mqgGYIPuQD/nLMuEWwq7GIL4ksW++jF0W4Gs4p+b/MVVbR2rG26Dcb8d6thPcUdPWnc1UAzBBziDJkV5X6Hyiqy7sqSGlT8df1IsaAXRLN13b09uaaRtH5jM0dLlh9sE42IfUSwOjiOB79awGYYHvNPKhpLsyyqS66g2Fnqh3TXIctoeWcXKcw9xJc2yC3qe79P28xsub+UqOcVR7FL8wsd90P1hNcuIStc3ngGZDu2f/w7Rh5BjelEnfd1dNcEuef7NmXgMwQU4hH0juxLg40VVy5Ja3XfJB/Vm92J0hE+RiHXKBMkdaI3Bb54yVZDl+Lr+55bANyjDpyadVx7V5bi7TGQJi4HG7G5P2kK6ZeYk9iSbhcGbRVXL8aoL7cTtPjmrl9gR9Mp7UT3JsUG7cFl2OfTmfq4Fv98vfMHQEn8W2yRHcD64WTJAT5APJoEzUMHNZ1YWvJzhz7PoyVu1ROXZdPds3PhPDtDh4cuL6fL72ScxYnp1tVk2ckFmuDNaqVrbD1QFXL2rBBNkjH8itMmHMEbq36sKNiZ2SHJfWixoRz0wM1Klx/oeMHTOuXLWFtRO0fb02n7WDE+tWaxtZ5v7+jRLcqUXPPW9LDNuX5Xk59smaLqkPlkE28qH8k0wo5xnm17oXPcLQSeqP6sXZk2NfyGWQfLnpdGJiV100ofmXBEmnDRIe48H03ZqgeZ8vTXT1veGOnXsTfEY4WWEURj5/Xe2f+7Y3zmscuKNe1UyQkQ/+0zK5KtHVDf3ctUDD8tlIjkvzgR93r/AiSJCT9geZfR6fCaMWtsVYP30P6pXn4/tCZc3W1YrRd2ZeH+PaqCUTZOSDT/uyFWXcl8vyod+pma8s4gTJwFr0cPP71YrBMRQCZ1h9N7vKc26ZCWeuXbWLnS00S9okr22Y8WwWPRNkLPIE+eJE17eh/TjH+G/NfGU2EiSyX86Qhhm3hy7mTmvm+5LnZDCtV9VLI4m2l9zGem69qLaspBF39lCj22W0HTulDX7YhrmN7rgkvEc38/36m8S36tmRdFHCYYI7YILUCi1nSQ9m8tZ6qRU6wz26nu1PnpP2rNyCOoqtE7gt8pAc44xdtm229OKVEo9KtO0AY8EzQWohOD9BWWRb3C9NY+6+JQGRiOjEZJjhWLt2T4JbWacdnCsJcc0ETYi+m6Ai8d4sX5nYK2GxWw8TpFZ4SQg01eFe5bbWTAw8tlCel6Fc90xwFjvfSI4vzDH9e704uSTAjTLh5gUaodN4nRsiqOzaNkG/A+dkm1GvgJozJkgtFJS7MVxCW4flLJJ2iANJQmJwMAbmn8/+Fjl73j7HMm25aBIfjc65I2i6Wx5fnnhdPSsTpBaEJAduAzypXmrldxJvrGcHk+emlyaa/3yjWjG36FBlqxzDuFYDU+DuIe4imslxSaacVS56JkgtJNwJRRvFtv4qZ5FPaeYHkgTFpS29/TCY21x0hEyzp1cmXprn7reyiB6q+kGRw3Pr2cXNBKkFI4mC9n+cBbYddIvem1qXZeb5H0xQtvesBPf0z8ZYQyRfRsHcNM91dmKQ1zru3u8ZdD2ezgrJBKmFhltG2zaax945ixyqc9kkrW8nGB6B+/sZtbKLbu7oU/L0BHf+HJZocxvrIGPrcI/4omeC1IKSxMFZ5IkJpm0w7tB0wy/0LcdyQ+KAzK6f2D/x9wnGyu7nzJIyVZrhcLZIJdAG2dexiWEaxVPr3g8S+rX17OJmm6doyp1WlA4IfpAvybgPeo5/w0wG6r5rlt2eY6TyYEyOcYNMdqiXBsIl5Cezv4HK9fJ8u2dCWVobrZ6zHzkuvnNcvvKZI3HSQUrpDJc2ldw7Tc/j383z38fKrmy29GIqom5K0NRnOu+4ea3dKSpY9EyQ0iKSJEnxAZVZU3XwQdnpXkmQDioXXmJLi0gS382Z0L8mwxhztkpRBJfzdKF3eGIPk+MjPIOUFqmm4TgddVAmujSJsW25rSRJkiRJkiSpBStp1IlVV92FUQbpnby06Ttg2Qxdb0mjzgQZ+XI/JxP69SsYDY4BncZM2OauPP7BZl6R94faUG5P435mbJb36JZmXloh2Q6yRhdQDNZeYrIOC3q32Y8Vw0pSOSbxkyZ6E7SkEWCCnNzLk7AYK3u2ccsXZ15EuTSVNCJMkJOjw4LWA0Elua6UWD0xU9Lj/uR5k+NbJbEax9us6ht/k+A1dlZMk32tnFiDabNKmleWQUa+kL3jYtOTCRUOdFiwzbJll3yVlRO2uTbrt2rmx2SbtTNhSNB9EvS9xy1c9DL9rmw/NiZ0tntFJnSHxTgga7Au6BG6dE5weLa/OdtRzvlH9aqq84Qzmnn2cXImjIeNs/IY3WpV8tipmbBvvDuPjXUckccoIzw0wevhLJnxR/4j8ckE247rICHbr5bJ5fVSNZbJUQluSaPfRe7nvSh/s2e2m7IMMo/xXnB87AufzmPva+Z5nPeS10OHs2zz8wQd374/cUm29Q4PzQt/qZd3SYJbr3hvGPmtL/mSPzGT6xPHJkrHpJyJUrlzYR5ngPuC7vkZsL8kR3C5TS/OROnu/qeJsm43VvSgHLQ8NlZ+mefhR48hSctjdycqeYznuzTBQPvPSJTBmehVhrLVr2ebp1ZrHsE2HC/72jHBeCUkrtLZwR3NdFLZH7ez0c0XPfmwD46P+4AreZwkz5AFz0+UBEqvM6z/XOKvWSHNBxPk8hh8id5O8Lx8gWfspr5JAhcmymBInJFxhsRZEzf+kxTeme2elCnoLp/E1dsbNM/LOqJ0s0XiKDbP31fjF2f6B5mUfWGr5hjw+ATJGuzzm/Vs5czE9vVs1UkBff7xWsvzccl/UXmeSTAKHn0l8np4DXR2MOVAWdkP2703Uc5m6cZrj5wRcoZYHn97opx1XpM4PvHRxP8mGIzqYwlpXpggl0eCeVc9W3lbvsicCU7XwwlncM+uZ6sksEWSwGsTdJZahhMl6ezLTNZzFsYZ4/0sN16V9es3wZkorkuUcZfp27Cc3ZFwSC4lsT02USqVOGPlMXwt+6q2yWvYNJPe2ncS3dZ5fOdMOTstyZr9VMc5CZIwwWviLLm6xE5M5aAEl+Mg4e2W5/thvVhhXxvXs5Wj8vgpCYognp7YPfOcRUvzwgS5vMckKP/6p2qpHl9krwRf8Kn0Xv6ek3gwCYnKBi5p2U8pQ9uimfYlyYEE2jtSHpe62KaZMrRASZJlHd38F1c2U9ArdbmkfiBxWvZfHVemXHZz9lbQ2exUzsv2lKk+lPhV4uFm/UQcB2esJGu22SfbTmwXyfreoQPOy3vGkAerZ9u7E7c366V5YYJcHl9OEgeVEKVrfMrnpuvdufcsiNpvkmkJLnHLGR3Jd1C9l9lbJnmwr+3qxeoSudytUi6dOYMsGJ+l6C1bpMdvkmSv3kvlieWQvehQtR8UMZQyRS7Hq8quXjkGzloZqpXKLHCW+6nEXXmdpyXobVuaNybI5VXlb/nyfi2TUvtLTTKXfFOZqsxuoqrsbUBXNFNsnuCytnSZf2MT2DoJhUvWMuAUtfG9Z5+ljBIPNtNe5VIe0zVP6rdGmYqWgmILhkNdTt5nKnBemOCHpOybxHhM4oa8Jso9pXlhgpwegz+VS8gDE1NdTvZeJlK2R4/NkwVla4MiUZezPRIjl9mlTJTkWMorH5fgsbWqpSVLrkvy6S037T3G9ZppL2qyi0FGv5sORRWlCOCVSXalGGCcHCdnyfwIUZP92UQ5c6fSiOY/0rwwQU4jX1xqUf+uXqouXUlMk7m6mYKmMLfkb78xSVCBU3C21FuLTTvC5eRvOBOk/SG4ZN21nl1yRx4jkZWB8rn0pv1lOcbe8kf0HuN6SVY0ualkngqg0qYSwwy+X5C4qQA6q1qqP2tn5bnKZXeF506skdfy68TlCco/qckuuOyW5oUJcmaUKZZxjUtZ4kRUzJTLZxo7X5ov/Y6JJyQoNzw9cUT9cC2JgLO7sTaKcWS22TaxQ2LiaHzlMpvnp4E5SpkeY4nQnAe9Ixv2lj+CihiGEQX7uSDPs2+C9pi0/Szlo1xqM9TosF6d10gN9FsSZYxlkt0b6tkqOfL5o03kTZk/ILFugsvx3svq3lpvaU6ZIGeQLzlJ7AP10uSyzfcyoSKn4CyS2mt6BKIi5ejEm/Ll506bXmN31wTNazjr466VUglT9FbUlORZjVvcJNpymV0eIzH1lj+yHZe6BydK+SNtJc9PkBx7h7w9Ptt2UXtclWlmX0szoSKmeH3eh3JWSEKnhQBtOs9L0H6U96wURXCW/aF6Vpp7Jsj+0C6SmtgpJRGQRLnEHddNWoNkQYPs0symeE9issHcS3Oe4l8T5Sy26B3YfeLZIpfzE7fnGLl0ppyPs86JuFw/KNvQsLtrnGGXWnIqtD6cJElRADXipyTKe8v7U4oISKyH5Xj6rTWXOjfVJeOiki8rl5elkuLBfClva+bHZBvOcsoZ2gPZZtKzrGxHGRuVEZwR8mW/M3F1ti+XmeM0iYLtqaQgQbD9Vdl+XEVJtmN/vbXlN2Wbqgwzj1ExsyHzjfvyGGdjk8r21FJTBkmtOPNcen8lf7NcUs22/IiW+8FB2WdvA/dKtuPY6RKufKZuy3ZjteV5fJ1MaFxe3JrHSyN22otSNLFJgr/njPyKPE6SlCRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJkiRJc2jJkv8H96pNzQCxhcEAAAAASUVORK5CYII=",
        "swagger": {
          "swagger": "2.0",
          "info": {
            "title": "Zero Networks",
            "description": "Zero Networks Rest API",
            "version": "1.0"
          },
          "host": "[variables('urlHost')]",
          "basePath": "[variables('apiPath')]",
          "schemes": [
            "https"
          ],
          "consumes": [
            "application/json"
          ],
          "produces": [
            "application/json"
          ],
          "paths": {
            "/assets": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "$ref": "#/definitions/assetList"
                    }
                  }
                },
                "operationId": "Search for an Asset",
                "parameters": [
                  {
                    "name": "_limit",
                    "in": "query",
                    "required": true,
                    "type": "integer",
                    "default": 400,
                    "format": "int32",
                    "x-ms-visibility": "internal"
                  },
                  {
                    "name": "_search",
                    "in": "query",
                    "required": true,
                    "type": "string",
                    "format": ""
                  }
                ]
              }
            },
            "/entities/encode-ip": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string"
                        }
                      }
                    }
                  }
                },
                "operationId": "Encode IP Address to AssetId",
                "parameters": [
                  {
                    "name": "ip",
                    "in": "query",
                    "required": true,
                    "type": "string",
                    "description": "IP Address to encode"
                  }
                ]
              }
            },
            "/assets/searchId": {
              "get": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {
                        "assetId": {
                          "type": "string",
                          "description": "assetId"
                        }
                      }
                    }
                  }
                },
                "operationId": "Get AssetId by FQDN",
                "parameters": [
                  {
                    "name": "fqdn",
                    "in": "query",
                    "required": true,
                    "type": "string",
                    "format": ""
                  }
                ]
              }
            },
            "/assets/protect": {
              "post": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {}
                  }
                },
                "operationId": "Add asset to protection",
                "parameters": [
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "type": "object",
                      "properties": {
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "List of AssetIDs"
                        },
                        "protectAt": {
                          "type": "integer",
                          "format": "int64",
                          "description": "epoch(ms) when to move from learning to protection, 0 means protectNow"
                        }
                      }
                    }
                  }
                ]
              }
            },
            "/assets/unprotect": {
              "post": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "type": "object",
                      "properties": {}
                    }
                  }
                },
                "operationId": "Remove asset from protection",
                "parameters": [
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "type": "object",
                      "properties": {
                        "items": {
                          "type": "array",
                          "items": {
                            "type": "string"
                          },
                          "description": "List of AssetIDs"
                        }
                      }
                    }
                  }
                ]
              }
            },
            "/protection/rules/inbound-block": {
              "post": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "$ref": "#/definitions/ruleResponse"
                    }
                  }
                },
                "operationId": "Create Inbound Block rule",
                "parameters": [
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "$ref": "#/definitions/ruleBody"
                    }
                  }
                ]
              }
            },
            "/protection/rules/outbound-block": {
              "post": {
                "responses": {
                  "default": {
                    "description": "default",
                    "schema": {
                      "$ref": "#/definitions/ruleResponse"
                    }
                  }
                },
                "operationId": "Create Outbound Block rule",
                "parameters": [
                  {
                    "name": "body",
                    "in": "body",
                    "required": true,
                    "schema": {
                      "$ref": "#/definitions/ruleBody"
                    }
                  }
                ]
              }
            }
          },
          "definitions": {
            "assetList": {
              "properties": {
                "items": {
                  "items": {
                    "$ref": "#/definitions/asset"
                  },
                  "type": "array"
                }
              },
              "type": "object"
            },
            "asset": {
              "properties": {
                "assetType": {
                  "enum": [
                    0,
                    1,
                    2
                  ],
                  "format": "int32",
                  "type": "integer"
                },
                "domain": {
                  "example": "domain.local",
                  "type": "string"
                },
                "fqdn": {
                  "example": "laptoppc.domain.local",
                  "type": "string"
                },
                "id": {
                  "example": "a:a:6d020055",
                  "type": "string"
                },
                "ipAddresses": {
                  "items": {
                    "example": "1.1.1.1",
                    "type": "string"
                  },
                  "type": "array"
                },
                "isAccessible": {
                  "type": "boolean"
                },
                "managers": {
                  "items": {
                    "$ref": "#/definitions/manager"
                  },
                  "type": "array"
                },
                "name": {
                  "example": "laptoppc",
                  "type": "string"
                },
                "operatingSystem": {
                  "example": "Windows 10 Pro",
                  "type": "string"
                },
                "protectionState": {
                  "enum": [
                    0,
                    1,
                    2,
                    3,
                    4
                  ],
                  "format": "int32",
                  "type": "integer"
                },
                "source": {
                  "enum": [
                    0,
                    1,
                    2,
                    3
                  ],
                  "format": "int32",
                  "type": "integer"
                },
                "state": {
                  "$ref": "#/definitions/state"
                }
              },
              "type": "object"
            },
            "manager": {
              "properties": {
                "entityType": {
                  "enum": [
                    "user"
                  ],
                  "type": "string"
                },
                "id": {
                  "type": "string"
                },
                "name": {
                  "example": "User Name",
                  "type": "string"
                },
                "permission": {
                  "format": "int32",
                  "type": "integer"
                }
              },
              "type": "object"
            },
            "rule": {
              "properties": {
                "action": {
                  "format": "int32",
                  "type": "integer"
                },
                "createdAt": {
                  "description": "epoch timestamp",
                  "format": "int32",
                  "type": "integer"
                },
                "createdBy": {
                  "properties": {
                    "createdBy": {
                      "properties": {
                        "id": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "enforcementSource": {
                      "format": "int32",
                      "type": "integer"
                    },
                    "userRole": {
                      "format": "int32",
                      "type": "integer"
                    }
                  },
                  "type": "object"
                },
                "description": {
                  "type": "string"
                },
                "direction": {
                  "format": "int32",
                  "type": "integer"
                },
                "expiresAt": {
                  "format": "int32",
                  "type": "integer"
                },
                "id": {
                  "type": "string"
                },
                "localEntityId": {
                  "type": "string"
                },
                "localEntityInfo": {
                  "properties": {
                    "id": {
                      "type": "string"
                    },
                    "name": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                },
                "localProcessesList": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                "parentId": {
                  "type": "string"
                },
                "parentType": {
                  "format": "int32",
                  "type": "integer"
                },
                "portsList": {
                  "items": {
                    "properties": {
                      "ports": {
                        "type": "string"
                      },
                      "protocolType": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "remoteEntityIdsList": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                "remoteEntityInfos": {
                  "items": {
                    "properties": {
                      "id": {
                        "type": "string"
                      },
                      "name": {
                        "type": "string"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "state": {
                  "format": "int32",
                  "type": "integer"
                },
                "updatedAt": {
                  "description": "epoch timestamp",
                  "format": "int32",
                  "type": "integer"
                }
              },
              "type": "object"
            },
            "ruleBody": {
              "properties": {
                "description": {
                  "type": "string"
                },
                "expiresAt": {
                  "example": 0,
                  "format": "int32",
                  "type": "integer"
                },
                "localEntityId": {
                  "type": "string"
                },
                "localProcessesList": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                "portsList": {
                  "items": {
                    "properties": {
                      "ports": {
                        "type": "string"
                      },
                      "protocolType": {
                        "format": "int32",
                        "type": "integer"
                      }
                    },
                    "type": "object"
                  },
                  "type": "array"
                },
                "remoteEntityIdsList": {
                  "items": {
                    "type": "string"
                  },
                  "type": "array"
                },
                "state": {
                  "example": 1,
                  "format": "int32",
                  "type": "integer"
                }
              },
              "required": [
                "expiresAt",
                "localEntityId",
                "localProcessesList",
                "portsList",
                "remoteEntityIdsList",
                "state"
              ],
              "type": "object"
            },
            "ruleResponse": {
              "properties": {
                "item": {
                  "$ref": "#/definitions/rule"
                }
              },
              "type": "object"
            },
            "state": {
              "properties": {
                "assetId": {
                  "type": "string"
                },
                "isAssetConnected": {
                  "type": "boolean"
                },
                "lasDisconnectedAt": {
                  "description": "epoch timestamp",
                  "type": "integer"
                },
                "protectAt": {
                  "description": "epoch timestamp",
                  "format": "int64",
                  "type": "integer"
                },
                "protectionState": {
                  "enum": [
                    1,
                    3,
                    5
                  ],
                  "format": "int32",
                  "type": "integer"
                }
              },
              "type": "object"
            }
          },
          "parameters": {},
          "responses": {},
          "securityDefinitions": {
            "API Key": {
              "type": "apiKey",
              "in": "header",
              "name": "Authorization"
            }
          },
          "security": [
            {
              "API Key": []
            }
          ],
          "tags": []
        }
      }
    }
  ]
}