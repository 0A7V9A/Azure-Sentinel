Parser:
  Title: ASIM Empty Registry Event Table
  Version: '0.1.0'
  LastUpdated: June 29, 2021
Product:
  Name: Source Agnostic
Normalization:
  Schema: RegistryEvent
  Version: '0.1.0'
References:
- Title: ASIM Registry Schema
  Link: https://aka.ms/AzSentinelRegistryEventDoc
- Title: ASIM
  Link: https:/aka.ms/AzSentinelNormalization
Description: |
  The purpose of this KQL function is to generate and guarentee the schema columns for the ASIM Registry Event schema
ParserName: vimRegistryEmpty
ParserQuery: |
  let EmptyNewRegistryEvents = datatable(
  // ****** Mandatory LA fields ******
      TimeGenerated:datetime, // => EventEndTime
    _ResourceId:string,
    Type:string,
  // ****** Event fields ******
      EventType:string, // OK
      EventProduct:string, // OK 
      EventProductVersion:string, // OK
      EventCount:int, // OK
      EventMessage:string, // OK
      EventVendor:string, // OK
      EventSchemaVersion:string, // OK
      EventOriginalUid:string, // OK
      EventStartTime:datetime, // OK
      EventEndTime:datetime, // OK
      EventReportUrl:string, // OK
      AdditionalFields:dynamic, // OK
      // -- RegistryFields
      RegistryKey:string,
      RegistryValue:string,
      RegistryValueType:string,
      RegistryValueData:string,
      RegistryPreviousKey:string,
      RegistryPreviousValue:string,
      RegistryPreviousValueType:string,
      RegistryPreviiusValueData:string,
      // -- Device fields 
      DvcId:string, // OK
      DvcHostname:string, // OK
      DvcIpAddr:string, // OK
      DvcOs:string, // OK
      DvcOsVersion:string, // OK
      DvcMacAddr:string, // OK
      // -- User fields
      ActorUsername:string, // OK
      ActorUsernameType:string, // OK
      ActorUserId:string, // OK
      ActorUserIdType:string, // OK
      ActorUserSessionId:string, // OK
      // -- Process fields
      //ActingProcessCommandLine:string,
      ActingProcessName:string,
      ActingProcessId:string,
      ActingProcessGuid:string,
      ParentProcessName:string,
      ParentProcessId:string,
      ParentProcessGuid:string,
      // -- aliases
      Dvc:string,
      User:string,
      Process:string,
      CommandLine:string,
      Hash:string
      )[];
      EmptyNewRegistryEvents