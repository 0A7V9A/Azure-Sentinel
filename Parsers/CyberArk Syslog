//This is a Query Parser that you can use to map Syslog messsages to the CyberArk data format for creating Dashboards and Alerts

Syslog
| extend Time = EventTime 
| extend Source = Computer 
| extend MessageID = ProcessID  
| extend Vendor = ProcessName 
| extend deviceAction = extract("act=(.*?)suser=", 1, SyslogMessage) 
| extend sourceUserName = extract("suser=(.*?)fname=", 1, SyslogMessage) 
| extend fileName = extract("fname=(.*?)dvc=", 1, SyslogMessage) 
| extend deviceAddress = extract("dvc=(.*?)shost=", 1, SyslogMessage) 
| extend sourceHostName = extract("shost=(.*?)dhost=", 1, SyslogMessage) 
| extend destinationHostName = extract("dhost=(.*?)duser=", 1, SyslogMessage) 
| extend destinationUserName = extract("duser=(.*?)externalId=", 1, SyslogMessage) 
| extend externalId = extract("externalId=(.*?)app=", 1, SyslogMessage) 
| extend applicationProtocol = extract("app=(.*?)reason=", 1, SyslogMessage) 
| extend Reason = extract("reason=(.*?)cs1Label=", 1, SyslogMessage) 
| extend affectedUserName = extract("cs1=(.*?)cs2Label=", 1, SyslogMessage) 
| extend safeName = extract("cs2=(.*?)cs3Label=", 1, SyslogMessage) 
| extend deviceType = extract("cs3=(.*?)cs4Label=", 1, SyslogMessage) 
| extend Database = extract("cs4=(.*?)cs5Label=", 1, SyslogMessage) 
| extend otherInfo = extract("cs5=(.*?)cn1Label=", 1, SyslogMessage) 
| extend requestID = extract("cn1=(.*?)cn2Label=", 1, SyslogMessage) 
| extend ticketID = extract("cn2=(.*$)", 1, SyslogMessage) 
| extend Message = extract("msg=(.*$)", 1, SyslogMessage) 
