Parser:
  Title: Authentication ASIM parser for Cisco ISE
  Version: '1.0'
  LastUpdated: June 19, 2023
Product:
  Name: Cisco ISE
Normalization:
  Schema: Authentication
  Version: '0.1.3'
References:
- Title: ASIM Authentication Schema
  Link: https://aka.ms/ASimAuthenticationDoc
- Title: ASIM
  Link: https:/aka.ms/AboutASIM
- Title: Cisco ISE Security Events 
  Link: https://www.cisco.com/c/en/us/td/docs/security/ise/3-2/admin_guide/b_ise_admin_3_2/b_ISE_admin_32_maintain_monitor.html#ID58
Description: |
  This ASIM parser supports normalizing Cisco ISE events produced by the Microsoft Sentinel Cisco ISE connector to the ASIM Authentication schema.
ParserName: ASimAuthenticationCiscoIse
ParserParams:
  - Name: disabled
    Type: bool
    Default: false
ParserQuery: |
    let EventName=datatable(EventOriginalType:string, EventMessage:string, EventOriginalResultDetails:string)["25104","Plain text password authentication in external REST ID store server succeeded","Plain text password authentication in external REST ID store server succeeded","25105","Plain text password authentication in external REST ID store server failed","Plain text password authentication in external REST ID store server failed","25106","REST ID Store server indicated plain text password authentication failure","REST ID store server indicated plain text password authentication failure","25112","REST database indicated plain text password authentication failure","REST database indicated plain text password authentication failure","51000","Administrator authentication failed","Administrator authentication failed","51001","Administrator authentication succeeded","Administrator authentication succeeded","51002","Administrator logged off","Administrator logged off","51003","Session Timeout","Administrator had a session timeout","51004","Rejected administrator session from unauthorized client IP address","An attempt to start an administration session from an unauthorized client IP address was rejected. Check the client's administration access setting.","51005","Administrator authentication failed. Administrator account is disabled","Administrator authentication failed. Administrator account is disabled.","51006","Administrator authentication failed. Account is disabled due to inactivity","Administrator authentication failed. Account is disabled due to inactivity.","51007","Authentication failed. Account is disabled due to password expiration","Authentication failed. Account is disabled due to password expiration","51008","Administrator authentication failed. Account is disabled due to excessive failed authentication attempts","Administrator authentication failed. Account is disabled due to excessive failed authentication attempts.","51009","Authentication failed. ISE Runtime is not running","Authentication failed. ISE Runtime is not running","51020","Administrator authentication failed. Login username does not exist.","Administrator authentication failed. Login username does not exist.","51021","Administrator authentication failed. Wrong password.","Administrator authentication failed. Wrong password.","51022","Administrator authentication failed. System Error","Administrator authentication failed. System Error","51106","Authentication for web services failed","Authentication for web services failed.","60075","Sponsor has successfully authenticated","Sponsor has successfully authenticated","60076","Sponsor authentication has failed","Sponsor authentication has failed; please see Failure Code for more details","60077","MyDevices user authentication has failed","MyDevices user authentication has failed","60078","MyDevices user has successfully authenticated","MyDevices user has successfully authenticated","60080","A SSH CLI user has successfully logged in","A SSH CLI User has successfully logged in","60081","A SSH CLI user has attempted unsuccessfully to login","A SSH CLI user has attempted unsuccessfully to login","60082","A SSH CLI user has attempted to login, however account is locked out","A SSH CLI user has attempted to login, however account is locked out","60135","MyDevices user SSO logout has failed","MyDevices user SSO logout has failed","60136","Sponsor user SSO logout has failed","Sponsor user SSO logout has failed","60204","System root CLI account has successfully logged in","System root CLI account has successfully logged in","60205","A CLI user has logged in from console","A CLI user has logged in from console","60206","A CLI user has logged out from console","A CLI user has logged out from console","61012","ISE has authenticated against APIC successfully","ISE has authenticated against APIC successfully","61013","ISE failed to authenticate against APIC","ISE failed to authenticate against APIC","61014","ISE has refreshed authentication against APIC successfully","ISE has refreshed authentication against APIC successfully","61015","ISE failed to refresh authenticate against APIC","ISE failed to refresh authenticate against APIC","60507","ERS request rejected due to unauthorized user.","ERS request was rejected because the user who sent the request is unauthorized.","51025","Authentication for web services failed","Authentication for web services failed.","61076","Sponsor has been successfully logged out","Sponsor has been successfully logged out","61077","MyDevices has been successfully logged out","MyDevices has been successfully logged out","10000","Received Administrator authentication request","Handling incoming Administrator authentication request","10003","Internal error: Administrator authentication received blank Administrator name","Internal error: AAC RT component received Administrator authentication request","10004","Internal error: Administrator authentication received blank Administrator password","Internal error: AAC RT component received an Administrator authentication request with blank admin password","10005","Administrator authenticated successfully","Administrator authenticated successfully","10006","Administrator authentication failed","Administrator authentication failed","10007","Administrator authentication failed - DB Error","Administrator authentication failed - DB Error","22000","Authentication resulted in internal error","Authentication resulted in internal error","22002","Authentication complete","Authentication complete","22004","Wrong password","Wrong password","22028","Authentication failed and the advanced options are ignored","Authentication of the user failed and the advanced option settings specified in the identity portion of the relevant authentication policy were ignored. For PEAP, LEAP, EAP-FAST or RADIUS MSCHAP authentications, when authentication fails, ISE stops processing the request.","22037","Authentication Passed","Authentication Passed, Skipping Attribute Retrieval","22040","Wrong password or invalid shared secret","Wrong password or invalid shared secret","22091","Authentication failed. User account is disabled due to excessive failed authentication attempts at global level","Authentication failed. User account is disabled due to excessive failed authentication attempts at global level.","5400","Authentication failed","User authentication failed. See FailureReason for more information","5401","Authentication failed","User authentication failed. See FailureReason for more information","5412","TACACS+ authentication request ended with error","TACACS+ authentication request ended with an error","5418","Guest Authentication Failed","Guest Authentication failed; please see Failure code for more details","5447","MDM Authentication Passed","MDM Authentication passed","5448","MDM Authentication Failed","MDM Authentication failed; please see Failure code for more details","86010","Guest user authentication failed","Guest user authentication failed. Please check your password and account permission","86011","Guest user is not enabled","Guest user authentication failed. User is not enabled. Please contact your system administrator","86014","User is suspended","User authentication failed. User account is suspended","86020","Guest Unknown Error","User authentication failed. Please contact your System Administrator","24015","Authenticating user against LDAP Server","Authenticating user against LDAP Server","24020","User authentication against the LDAP Server failed","User authentication against the LDAP Server failed. The user entered the wrong password or the user record in the LDAP Server is disabled or expired","24021","User authentication ended with an error","User authentication against LDAP Server ended with an error","24022","User authentication succeeded","User authentication against LDAP Server succeeded","24050","Cannot authenticate with LDAP Identity Store because password was not present or was empty","ISE did not receive user password or received empty password. Plain password authentication cannot be performed with no password or empty password","24054","User authentication against LDAP server detected that user password has expired","The password has expired but there are remaining grace authentications. The user needs to change it","24055","User authentication against LDAP server detected that the user is authenticating for the first time after the password administrator set the password","The user needs to change his password immediately","24056","User authentication against LDAP server detected that user password has expired and there are no more grace authentications","The user needs to contact the password administrator in order to have its password reset","24057","User authentication against LDAP server detected that the password failure limit has been reached and the account is locked","The user needs to retry later or contact the password administrator to reset the password","24337","Authentication Ticket (TGT) request succeeded","Authentication Ticket (TGT) request succeeded","24338","Authentication Ticket (TGT) request failed","Authentication Ticket (TGT) request failed","24402","User authentication against Active Directory succeeded","User authentication against Active Directory succeeded","24403","User authentication against Active Directory failed","User authentication against Active Directory failed","24406","User authentication against Active Directory failed since user has invalid credentials","User authentication against Active Directory failed since user has invalid credentials","24407","User authentication against Active Directory failed since user is required to change his password","User authentication against Active Directory failed since user is required to change his password","24408","User authentication against Active Directory failed since user has entered the wrong password","User authentication against Active Directory failed since user has entered the wrong password","24409","User authentication against Active Directory failed since the user's account is disabled","User authentication against Active Directory failed since the user's account is disabled","24410","User authentication against Active Directory failed since user is considered to be in restricted logon hours","User authentication against Active Directory failed since user is considered to be in restricted logon hours","24414","User authentication against Active Directory failed since the user's account has expired","User authentication against Active Directory failed since the user's account has expired","24415","User authentication against Active Directory failed since user's account is locked out","User authentication against Active Directory failed since user's account is locked out","24418","Machine authentication against Active Directory failed since it is disabled in configuration","Machine authentication against Active Directory failed since it is disabled in configuration","24454","User authentication against Active Directory failed because of a timeout error","User authentication against Active Directory failed because of a timeout error","24470","Machine authentication against Active Directory is successful","Machine authentication against Active Directory is successful.","24484","Machine authentication against Active Directory has failed because the machine's password has expired","Machine authentication against Active Directory has failed because the machine's password has expired.","24485","Machine authentication against Active Directory has failed because of wrong password","Machine authentication against Active Directory has failed because of wrong password.","24486","Machine authentication against Active Directory has failed because the machine's account is disabled","Machine authentication against Active Directory has failed because the machine's account is disabled.","24487","Machine authentication against Active Directory failed since machine is considered to be in restricted logon hours","Machine authentication against Active Directory failed since machine is considered to be in restricted logon hours","24489","Machine authentication against Active Directory has failed because the machine's account has expired","Machine authentication against Active Directory has failed because the machine's account has expired.","24490","Machine authentication against Active Directory has failed because the machine's account is locked out","Machine authentication against Active Directory has failed because the machine's account is locked out.","24491","Machine authentication against Active Directory has failed because the machine has invalid credentials","Machine authentication against Active Directory has failed because the machine has invalid credentials.","24492","Machine authentication against Active Directory has failed","Machine authentication against Active Directory has failed.","24496","Authentication rejected due to a white or black list restriction","Authentication rejected due to a white or black list restriction","24505","User authentication has succeeded","User authentication against the RSA SecurID Server has succeeded.","24508","User authentication failed","User authentication against RSA SecurID Server failed","24518","User canceled New PIN operation; User authentication against RSA SecurIDServer failed","User canceled New PIN operation; User authentication against RSA SecurID Server failed","24547","RSA request timeout expired. RSA authentication session cancelled","RSA request timeout expired. RSA authentication session cancelled.","24612","Authentication against the RADIUS token server succeeded","Authentication against the RADIUS token server succeeded.","24613","Authentication against the RADIUS token server failed","Authentication against the RADIUS token server failed.","24614","RADIUS token server authentication failure is translated as Unknown user failure","RADIUS token server authentication failure is translated as Unknown user failure.","24639","Authentication passed via Passcode cache","User record was found in Passcode cache, passcode matches the passcode on the authentication request. Authentication passed via Passcode cache.","24704","Authentication failed because identity credentials are ambiguous","Authentication found several accounts matching to the given credentials (i.e identity name and password)","24705","Authentication failed because ISE server is not joined to required domains","Authentication failed because ISE server is not joined to required domains","24706","Authentication failed because NTLM was blocked","Authentication failed because NTLM was blocked","24707","Authentication failed because all identity names have been rejected","Authentication failed all identity names has been rejected according AD Identity Store Advanced Settings","24708","User not found in Active Directory. Some authentication domains were not available","User not found in Active Directory. Some authentication domains were not available during identity resolution","24709","Host not found in Active Directory. Some authentication domains were not available","Host not found in Active Directory. Some authentication domains were not available during identity resolution","24712","Authentication failed because domain trust is restricted","Authentication failed because domain trust is restricted","24814","The responding provider was unable to successfully authenticate the principal","The responding provider was unable to successfully authenticate the principal","24853","Plain text password authentication in external ODBC database succeeded","Plain text password authentication in external ODBC database succeeded","24854","Plain text password authentication in external ODBC database failed","Plain text password authentication in external ODBC database failed","24860","ODBC database indicated plain text password authentication failure","ODBC database indicated plain text password authentication failure","24890","Social Login operation failed","Social Login operation failed. Check the message details for more information","24716","Active Directory Kerberos ticket authentication succeeded","Active Directory Kerberos ticket authentication succeeded","24717","Active Directory Kerberos ticket authentication failed","Active Directory Kerberos ticket authentication failed","24719","Active Directory Kerberos ticket authentication failed because of the ISE account password mismatch, integrity check failure or expired ticket","Active Directory Kerberos ticket authentication failed because of the ISE account password mismatch, integrity check failure or expired ticket","89157","CMCS authentication failure","ISE is unable to authenticate with the Cisco MDM Cloud Service","89159","APNS authentication failure","ISE is unable to authenticate with the Apple Push Notification System (APNS)","89160","MDM User Authentication completed","The User Authentication part of mobile device enrollment has completed","33102","Successful user login to ISE configuration mode","ISE administrator logged in to ISE configuration mode","33103","User login to ISE configuration mode failed","Login to ISE configuration mode failed","5200","Authentication succeeded","User authentication ended successfully","5201","Authentication succeeded","User authentication ended successfully","5231","Guest Authentication Passed","Guest Authentication Passed","11002","Returned RADIUS Access-Accept","Returned RADIUS Access-Accept - authentication succeeded","11003","Returned RADIUS Access-Reject","Returned RADIUS Access-Reject - authentication failed","11039","RADIUS authentication request rejected due to critical logging error","A RADIUS authentication request was rejected due to a critical logging error.","11052","Authentication request dropped due to unsupported port number","An authentication request was dropped because it was received through an unsupported port number.","11812","EAP-MSCHAP authentication succeeded","EAP-MSCHAP authentication succeeded.","11813","EAP-MSCHAP authentication failed","EAP-MSCHAP authentication failed.","11814","Inner EAP-MSCHAP authentication succeeded","EAP-MSCHAP authentication for the inner EAP method succeeded.","11815","Inner EAP-MSCHAP authentication failed","EAP-MSCHAP authentication for the inner EAP method failed.","11823","EAP-MSCHAP authentication attempt failed","EAP-MSCHAP authentication attempt failed.","11824","EAP-MSCHAP authentication attempt passed","EAP-MSCHAP authentication attempt passed.","12005","EAP-MD5 authentication succeeded","EAP-MD5 authentication succeeded.","12006","EAP-MD5 authentication failed","EAP-MD5 authentication failed.","12208","Client certificate was received but authentication failed","ISE received client certificate during tunnel establishment or inside the tunnel but the authentication failed.","12306","PEAP authentication succeeded","PEAP authentication succeeded.","12307","PEAP authentication failed","PEAP authentication failed.","12308","Client sent Result TLV indicating failure","Internal error, possibly in the supplicant: PEAP v0 authentication failed because client sent Result TLV indicating failure. Client indicates that it does not support Crypto-Binding TLV","12506","EAP-TLS authentication succeeded","EAP-TLS authentication succeeded.","12507","EAP-TLS authentication failed","EAP-TLS authentication failed.","12528","Inner EAP-TLS authentication succeeded","EAP-TLS authentication for the inner EAP method succeeded.","12529","Inner EAP-TLS authentication failed","EAP-TLS authentication for the inner EAP method failed.","12612","EAP-GTC authentication succeeded","EAP-GTC authentication has succeeded.","12613","EAP-GTC authentication failed","EAP-GTC authentication has failed.","12614","Inner EAP-GTC authentication succeeded","EAP-GTC authentication for the inner EAP method has succeeded.","12615","Inner EAP-GTC authentication failed","EAP-GTC authentication for the inner EAP method has failed.","12623","EAP-GTC authentication attempt failed","The EAP-GTC authentication attempt has failed.","12624","EAP-GTC authentication attempt passed","The EAP-GTC authentication attempt has passed.","12705","LEAP authentication passed; Continuing protocol","LEAP authentication passed. Continue LEAP protocol.","12706","LEAP authentication failed; Finishing protocol","LEAP authentication has failed. Protocol finished with a failure.","12707","LEAP authentication error; Finishing protocol","A LEAP authentication error has occurred. Protocol finished with an error.","12854","Cannot authenticate because password was not present or was empty","ISE did not receive user password or received empty password. Plain password authentication cannot be performed with no password or empty password","12975","EAP-TTLS authentication succeeded","EAP-TTLS authentication succeeded.","12976","EAP-TTLS authentication failed","EAP-TTLS authentication failed.","11700","5G AKA Authentication succeeded","5G AKA Authentication succeeded."];
    let logon_evts = dynamic(["25104","51001","60075","60078","60080","60204","60205","61012","61014","10005","22037","5447","24015","24022","24337","24402","24470","24505","24612","24639","24853","24716","89160","33102","5200","5201","5231","11002","11812","11814","11824","12005","12306","12506","12528","12612","12614","12624","12705","12975","11700","25105","25106","25112","51000","60081","10006","22028","86010","24403","24406","24491","24492","24854","24860","51020","60507","10003","24614","24708","24709","24412","51021","10004","22004","22040","24020","24050","24408","24485","24719","12854","24414","24489","24054","24055","24056","24407","24484","60082","24415","24490","51005","51006","51007","86011","86014","24409","24486","51004","51008","22091","24057","24410","24418","24487","24496","24508","24704","24712","51003","24454","24547","51009","51022","51106","60076","60077","61013","61015","51025","10007","22000","5400","5401","5412","5418","5448","86020","24021","24338","24518","24613","24705","24706","24707","24814","24890","24717","89157","89159","33103","11003","11039","11052","11813","11815","11823","12006","12208","12307","12308","12507","12529","12613","12615","12623","12706","12707","12976"]);
    let reslt_success_evts = dynamic(["25104","51001","60075","60078","60080","60204","60205","61012","61014","10005","22037","5447","24015","24022","24337","24402","24470","24505","24612","24639","24853","24716","89160","33102","5200","5201","5231","11002","11812","11814","11824","12005","12306","12506","12528","12612","12614","12624","12705","12975","11700","51002","60206","61076","61077"]);
    let freason_no_usr_passwd = dynamic(["25105","25106","25112","51000","60081","10006","22028","86010","24403","24406","24491","24492","24854","24860"]);
    let freason_no_usr = dynamic(["51020","60507","10003","24614","24708","24709","24412"]);
    let freason_incorrect_passwd = dynamic(["51021","10004","22004","22040","24020","24050","24408","24485","24719","12854"]);
    let freason_incorrect_key = dynamic([]);        //for future updates
    let freason_acc_expired = dynamic(["24414","24489"]);
    let freason_passwd_expired = dynamic(["24054","24055","24056","24407","24484"]);
    let freason_user_locked = dynamic(["60082","24415","24490"]);
    let freason_user_disabled = dynamic(["51005","51006","51007","86011","86014","24409","24486"]);
    let freason_policy_violation = dynamic(["51004","51008","22091","24057","24410","24418","24487","24496","24508","24704","24712"]);
    let freason_session_expired = dynamic(["51003","24454","24547"]);
    let freason_other = dynamic(["51009","51022","51106","60076","60077","61013","61015","51025","10007","22000","5400","5401","5412","5418","5448","86020","24021","24338","24518","24613","24705","24706","24707","24814","24890","24717","89157","89159","33103","11003","11039","11052","11813","11815","11823","12006","12208","12307","12308","12507","12529","12613","12615","12623","12706","12707","12976","60135","60136"]);
    let CiscoISEAuthParser=(disabled:bool=false){
      Syslog
      | where not(disabled)
      | where ProcessName has_any ("CISE", "CSCO")
      | extend EventOriginalType = extract(@".*\d{10}\s(\d{4,5})\s.*", 1, SyslogMessage)
      | where EventOriginalType in ("25104","25105","25106","25112","51000","51001","51002","51003","51004","51005","51006","51007","51008","51009","51020","51021","51022","51106","60075","60076","60077","60078","60080","60081","60082","60135","60136","60204","60205","60206","61012","61013","61014","61015","60507","51025","61076","61077","10003","10004","10005","10006","10007","22000","22004","22028","22037","22040","22091","5400","5401","5412","5418","5447","5448","86010","86011","86014","86020","24015","24020","24021","24022","24050","24054","24055","24056","24057","24337","24338","24402","24403","24406","24407","24408","24409","24410","24414","24415","24418","24454","24470","24484","24485","24486","24487","24489","24490","24491","24492","24496","24505","24508","24518","24547","24612","24613","24614","24639","24704","24705","24706","24707","24708","24709","24712","24814","24853","24854","24860","24890","24716","24717","24719","89157","89159","89160","33102","33103","5200","5201","5231","11002","11003","11039","11052","11812","11813","11814","11815","11823","11824","12005","12006","12208","12306","12307","12308","12506","12507","12528","12529","12612","12613","12614","12615","12623","12624","12705","12706","12707","12854","12975","12976","11700")
      | extend 
          EventVendor = "Cisco"
          , EventProduct = "ISE"
          , EventProductVersion = "3.2"
          , EventCount = int(1)
          , EventSchema = "Authentication"
          , EventSchemaVersion = "0.1.3"
          , EventStartTime = coalesce(EventTime, TimeGenerated)
          , EventEndTime = coalesce(EventTime, TimeGenerated)
          , EventOriginalSeverity = extract(@".*(NOTICE|INFO|WARN|WARNING|ERROR|FATAL|DEBUG).*", 1, SyslogMessage)
          , EventType = case(EventOriginalType in (logon_evts), "Logon", "Logoff")
      | lookup EventName on EventOriginalType 
      | extend FailureReason = tostring(extract(@"FailureReason=\d+\s(.*?)", 1, SyslogMessage))
      | extend EventOriginalResultDetails = case(isnotempty(FailureReason), FailureReason, EventOriginalResultDetails)
              , EventResult = case(EventOriginalType in (reslt_success_evts), "Success", "Failure")
      | extend EventSeverity = case(EventResult == "Failure", "Low", "Informational")
      | extend EventResultDetails = case(EventOriginalType in (freason_no_usr_passwd), "No such user or password",
                                          EventOriginalType in (freason_no_usr), "No such user",
                                          EventOriginalType in (freason_incorrect_passwd),"Incorrect password",
                                          EventOriginalType in (freason_incorrect_key), "Incorrect key",
                                          EventOriginalType in (freason_acc_expired), "Account expired",
                                          EventOriginalType in (freason_passwd_expired), "Password expired",
                                          EventOriginalType in (freason_user_locked), "User locked",
                                          EventOriginalType in (freason_user_disabled), "User disabled",
                                          EventOriginalType in (freason_policy_violation), "Logon violates policy",
                                          EventOriginalType in (freason_session_expired), "Session expired",
                                          EventOriginalType in (freason_other), "Other",
                                          EventResult == "Success", "", "N/A")
      //Dvc specific fields
      | extend 
            DvcIpAddr = extract(@"(d{1,3}\.\d{1.3}\.\d{1,3}\.\d{1,3})", 1, Computer)
          , DvcHostname = coalesce(tostring(extract(@"NetworkDeviceName=(.*?),", 1, SyslogMessage)), Computer, HostName)
      //Authentication specific fields
          , LogonProtocol = extract(@"Protocol=(.*?),", 1, SyslogMessage)
      //Target specific fields
          , TargetIpAddr = extract(@"DestinationIPAddress=(.*?),", 1, SyslogMessage)
          , TargetPortNumber = toint(extract(@"DestinationPort=(.*?),", 1, SyslogMessage))
          , TargetMacAddr = tostring(extract(@"Called-Station-ID=([a-fA-F0-9\-:]{17}),", 1, SyslogMessage))
          , TargetUsername = coalesce(tostring(extract(@"User-Name=(.*?),", 1, SyslogMessage)), tostring(extract(@"UserName=(.*?),", 1, SyslogMessage)), tostring(extract(@"User=(.*?),", 1, SyslogMessage)))
          , TargetUsernameType = case(EventMessage has_any ("host", "machine"), "Machine",
                                      EventMessage has_any ("administrator", "root"), "Admin", "Regular")
          , TargetSessionId = tostring(extract(@"SessionID=([a-fA-F0-9]+),", 1, SyslogMessage))
      //Src specific fields
      | extend 
          SrcIpAddr = case(SyslogMessage has "Remote-Address", extract(@"Remote-Address=(.*?),", 1, SyslogMessage),
                            SyslogMessage matches regex @"Caller-Station-ID=\d{1,3}\.\d{1.3}\.\d{1,3}\.\d{1,3}", extract(@"Caller-Station-ID=(\d{1,3}\.\d{1.3}\.\d{1,3}\.\d{1,3})", 1, SyslogMessage), extract(@"Device IP Address=(.*?),", 1, SyslogMessage))
          , SrcPortNumber = toint(extract(@"Device Port=(\d{1,5})", 1, SyslogMessage))
          , SrcMacAddr = coalesce(replace_string(tostring(extract(@"Caller-Station-ID=([a-fA-F0-9\-:]{17})", 1, SyslogMessage)), "-", ":"), tostring(extract(@"device-mac=(.*?),", 1, SyslogMessage)))
      | extend 
          SrcHostname = case(SyslogMessage matches regex @"Caller-Station-ID=\d{1,3}\.\d{1.3}\.\d{1,3}\.\d{1,3}", "",
                          isnotempty(SrcMacAddr), "",
                          tostring(extract(@"Caller-Station-ID=([a-fA-F0-9\-]{17})", 1, SyslogMessage)))
      // ************************************* 
      //            <Aliases> 
      // *************************************
      | extend 
          Dvc = coalesce(DvcIpAddr, DvcHostname)
          , IpAddr = SrcIpAddr
          , Dst = TargetIpAddr
          , Src = SrcIpAddr
          , User = TargetUsername
      // ************************************* 
      //            </Aliases> 
      // *************************************
      | project-away TenantId, SourceSystem, MG, Computer, EventTime, Facility, HostName, SeverityLevel, SyslogMessage, HostIP, ProcessName, ProcessID, _ResourceId, FailureReason
    };
    CiscoISEAuthParser(disabled)