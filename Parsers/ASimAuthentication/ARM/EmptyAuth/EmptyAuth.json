{
    "$schema": "https://schema.management.azure.com/schemas/2019-08-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspaceName": {
            "type": "string"
        },
        "location": {
          "type": "string"
        }
    },
    "resources": [
      {
        "type": "Microsoft.OperationalInsights/workspaces",
        "apiVersion": "2017-03-15-preview",
        "name": "[parameters('workspaceName')]",
        "location": "[parameters('location')]",
        "resources": [
          {
            "type": "savedSearches",
            "apiVersion": "2020-08-01",
            "name": "vimAuthEmpty",
              "dependsOn": [
                "[concat('Microsoft.OperationalInsights/workspaces/', parameters('workspaceName'))]"
              ],
              "properties": {
                "etag": "*",
                "displayName": "Microsoft Sentinel Information Model Authentication - Empty Table",
                "category": "Security",
                "FunctionAlias": "vimAuthEmpty",
                "query": "let EmptyAuthenticationTable=(){\nlet schema=datatable(\n    EventProduct:string\n  , EventUid:string\n  , TimeGenerated:datetime\n  , EventOriginalId:string\n  , EventMessage:string\n  , EventResult:string\n  , EventResultDetails:string\n  , EventStartTime:datetime\n  , EventEndTime:datetime\n  , EventType:string\n  , EventSubType:string\n  , EventKind:string\n  , SessionId:string\n  , SessionDuration:long\n  , ActorUserId:string\n  , ActorUserName:string\n  , ActorUserDomain:string\n  , ActorUserType:string\n  , TargetUserId:string\n  , TargetUserName:string\n  , TargetUserDomain:string\n  , TargetUserType:string\n  , SrcDvcId:string\n  , SrcDvcHostname:string\n  , SrcDvcDoamin:string\n  , SrcDvcType:string\n  , SrcDvcIpAddr:string\n  , SrcDvcOs:string\n  , HttpUserAgentOriginal :string\n  , HttpUserAgentName:string\n  , SourceIsp:string\n  , SrcGeoCity:string\n  , SrcGeoCountry:string\n  , SrcGeoRegion:string\n  , SrcPortNumber:int\n  , ProcessId:string\n  , ProcessName:string\n  , AppId:string\n  , AppName:string\n  , DstDvcId:string\n  , DstDvcHostname:string\n  , DstDvcDomain:string\n  , DstDvcType:string\n  , DstDvcIpAddr:string\n  , DstDvcOs:string\n  , urlOriginal:string\n  , DstGeoCity:string\n  , DstGeoCountry:string\n  , DstGeoRegion:string\n  , DstPortNumber:long\n  , _ResourceId:string\n  , ResourceName:string\n  )[];\n  schema\n};\nEmptyAuthenticationTable\n",
                "version": 1
            }
          }
        ]
      }
    ]
  }