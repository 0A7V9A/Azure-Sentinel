Parser:
  Title: Windows Firewall Network Sessions
  Version: '0.0'
  LastUpdated: June 20, 2021
Product:
  Name: WindowsFirewall
Normalization:
  Schema: NetworkSessions
  Version: '0.1.0'
References:
- Title: Using functions
  Link: https://docs.microsoft.com/azure/azure-monitor/log-query/function
- Title: Network Sessions schema documentation
  Link: https://aka.ms/AzSentinelNetworkSessionsDoc
Description: |
  This is a Query Parser that is used to map Windows Firewall Events (WindowsFirewall) to the Azure Sentinel Information Model Network Sessions schema.
ParserName: vimNetworkSessionMicrosoftWindowsFirewall
ParserQuery: |
  let NetworkParserWindowsFirewall=(){ WindowsFirewall
  | extend EventType = "Traffic"
  , EventSchemaVersion="1.0.0"
  , EventCount=toint(1) 
  , EventVendor = "Microsoft"
  , EventProduct = "WindowsFirewall"
  , EventResult="Success"
  , EventTimeIngested = ingestion_time()
  , EventSeverity=tostring(Severity)
  | project-rename 
  DvcAction=FirewallAction,
   DvcHostname = Computer, 
   EventResourceId = _ResourceId,
   NetworkProtocol = Protocol, 
   EventOriginalUid = _ItemId, 
   EventMessage = Description, 
  SrcIpAddr=SourceIP,
   DstIpAddr=DestinationIP,
   DstPortNumber=DestinationPort,
   SrcPortNumber=SourcePort,
   EventReportUrl = ReportReferenceLink};
  NetworkParserWindowsFirewall
